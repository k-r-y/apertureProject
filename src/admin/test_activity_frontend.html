<!DOCTYPE html>
<html>
  <head>
    <title>Activity Log Test</title>
    <style>
      body {
        font-family: Arial;
        padding: 20px;
        background: #1a1a1a;
        color: #fff;
      }
      .success {
        color: #28a745;
      }
      .error {
        color: #dc3545;
      }
      #output {
        white-space: pre-wrap;
        background: #222;
        padding: 15px;
        border: 1px solid #444;
      }
    </style>
  </head>
  <body>
    <h1>üîç Activity Log Frontend Test</h1>
    <button
      onclick="testAPI()"
      style="
        background: #d4af37;
        color: #000;
        padding: 10px 20px;
        border: none;
        cursor: pointer;
      "
    >
      Test API
    </button>
    <div id="output"></div>

    <script>
      function testAPI() {
        const output = document.getElementById("output");
        output.innerHTML = "Testing API...\\n";

        fetch("api/inquiries_api.php?action=get_activity_log")
          .then((r) => {
            output.innerHTML += `Response Status: ${r.status} ${
              r.ok ? "‚úÖ" : "‚ùå"
            }\\n`;
            return r.json();
          })
          .then((data) => {
            output.innerHTML += `\\nData received:\\n`;
            output.innerHTML += `Success: ${data.success ? "‚úÖ" : "‚ùå"}\\n`;
            output.innerHTML += `Activities count: ${
              data.activities ? data.activities.length : 0
            }\\n`;

            if (data.activities && data.activities.length > 0) {
              output.innerHTML += `\\nFirst activity sample:\\n`;
              const act = data.activities[0];
              output.innerHTML += `- activity_id: ${act.activity_id}\\n`;
              output.innerHTML += `- FirstName: ${act.FirstName}\\n`;
              output.innerHTML += `- LastName: ${act.LastName}\\n`;
              output.innerHTML += `- activity_type: ${act.activity_type}\\n`;
              output.innerHTML += `- activity_description: ${act.activity_description}\\n`;

              output.innerHTML += `\\n‚úÖ API is working correctly!\\n`;
              output.innerHTML += `\\nTrying to render HTML...\\n`;

              try {
                const html = data.activities
                  .map(
                    (act) => `
                                <tr>
                                    <td><div class="fw-bold text-light">${act.FirstName} ${act.LastName}</div></td>
                                    <td>${act.activity_type}</td>
                                </tr>
                            `
                  )
                  .join("");

                output.innerHTML += `‚úÖ HTML render successful! Generated ${html.length} characters\\n`;
              } catch (e) {
                output.innerHTML += `‚ùå HTML render error: ${e.message}\\n`;
              }
            } else {
              output.innerHTML += `‚ùå No activities found\\n`;
            }
          })
          .catch((error) => {
            output.innerHTML += `\\n‚ùå ERROR: ${error.message}\\n`;
            output.innerHTML += `Stack: ${error.stack}\\n`;
          });
      }
    </script>
  </body>
</html>
