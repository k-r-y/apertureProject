<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Aperture System Documentation</title>
    <style>
      @import url("https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600&family=Playfair+Display:wght@600;700&display=swap");
      :root {
        --primary: #d4af37;
        --dark: #1a1a1a;
        --light: #f5f5f5;
        --text: #333;
      }
      body {
        font-family: "Inter", sans-serif;
        line-height: 1.6;
        color: var(--text);
        max-width: 900px;
        margin: 0 auto;
        padding: 40px;
        background: #fff;
      }
      h1,
      h2,
      h3 {
        font-family: "Playfair Display", serif;
        color: var(--dark);
        margin-top: 2em;
      }
      h1 {
        font-size: 3em;
        border-bottom: 4px solid var(--primary);
        padding-bottom: 20px;
        margin-top: 0;
      }
      h2 {
        font-size: 2em;
        border-left: 5px solid var(--primary);
        padding-left: 15px;
        background: #f9f9f9;
        padding: 10px 15px;
      }
      h3 {
        font-size: 1.4em;
        color: #555;
      }
      p {
        margin-bottom: 1.2em;
        text-align: justify;
      }
      ul,
      ol {
        margin-bottom: 1.5em;
      }
      li {
        margin-bottom: 0.5em;
      }
      code {
        background: #f4f4f4;
        padding: 2px 5px;
        border-radius: 3px;
        font-family: "Courier New", Courier, monospace;
        font-size: 0.9em;
        color: #d63384;
      }
      pre {
        background: #2d2d2d;
        color: #f8f8f2;
        padding: 15px;
        border-radius: 5px;
        overflow-x: auto;
        font-size: 0.9em;
      }
      pre code {
        background: transparent;
        color: inherit;
        padding: 0;
      }
      .badge {
        display: inline-block;
        padding: 3px 8px;
        border-radius: 4px;
        font-size: 0.8em;
        font-weight: bold;
        color: white;
        background: var(--primary);
      }
      .toc {
        background: #f9f9f9;
        padding: 20px;
        border-radius: 8px;
        border: 1px solid #ddd;
        margin-bottom: 40px;
      }
      .toc h2 {
        margin-top: 0;
        font-size: 1.5em;
        border: none;
        padding: 0;
        background: transparent;
      }
      .toc ul {
        list-style: none;
        padding-left: 0;
      }
      .toc a {
        text-decoration: none;
        color: var(--dark);
        font-weight: 500;
      }
      .toc a:hover {
        color: var(--primary);
      }
      @media print {
        body {
          padding: 0;
          max-width: 100%;
        }
        h1 {
          margin-top: 0;
        }
        .page-break {
          page-break-before: always;
        }
        a {
          text-decoration: none;
          color: black;
        }
        pre {
          white-space: pre-wrap;
          word-wrap: break-word;
        }
      }
    </style>
  </head>
  <body>
    <h1>Aperture Photography System</h1>
    <p><strong>Comprehensive Documentation & Technical Architecture</strong></p>
    <p><em>Generated on November 26, 2025</em></p>
    <div class="toc">
      <h2>Table of Contents</h2>
      <ul>
        <li><a href="#executive-summary">1. Executive Summary</a></li>
        <li>
          <a href="#business-process">2. Business Process & User Experience</a>
        </li>
        <li><a href="#admin-journey">3. The Admin Journey</a></li>
        <li>
          <a href="#improvements">4. Key Features & Recent Improvements</a>
        </li>
        <li><a href="#swot">5. SWOT Analysis</a></li>
        <li><a href="#architecture">6. System Architecture</a></li>
        <li><a href="#database">7. Database Design</a></li>
        <li><a href="#security">8. Security & API</a></li>
      </ul>
    </div>
    <h2 id="executive-summary">1. Executive Summary</h2>
    <p>
      <strong>Aperture</strong> is a premium photography booking management
      system designed to provide a seamless, luxury experience for clients while
      offering powerful tools for administrators. The system manages the entire
      lifecycle of a photography serviceâ€”from the initial inquiry and booking to
      payment processing, service delivery, and final review.
    </p>
    <h2 id="business-process">2. Business Process & User Experience</h2>
    <h3>A. The Client Journey</h3>
    <p>The system guides the user effortlessly through the following stages:</p>
    <h4>Phase 1: Discovery & Registration</h4>
    <ul>
      <li>
        <strong>User Goal:</strong> Find a photographer and create an account.
      </li>
      <li>
        <strong>Experience:</strong> Users land on a visually striking homepage
        showcasing the portfolio. To book, they must register.
      </li>
      <li>
        <strong>Process:</strong>
        <ol>
          <li>User signs up (Name, Email, Password).</li>
          <li>System creates a secure account (hashed passwords).</li>
          <li>User logs in to access the <strong>Client Dashboard</strong>.</li>
        </ol>
      </li>
    </ul>
    <h4>Phase 2: The Booking Process</h4>
    <ul>
      <li><strong>User Goal:</strong> Secure a photoshoot date.</li>
      <li>
        <strong>Experience:</strong>
        <ol>
          <li>
            <strong>Package Selection:</strong> User chooses from Basic,
            Standard, or Premium packages.
          </li>
          <li>
            <strong>Availability Check:</strong> User selects a date. The system
            enforces a strict <strong>"One Booking Per Day"</strong> rule to
            ensure exclusivity.
          </li>
          <li>
            <strong>Booking Form:</strong> User fills in event details (Time,
            Location, Theme).
          </li>
          <li>
            <strong>Payment:</strong> User is prompted to pay a 50% downpayment.
            They upload a
            <strong>Proof of Payment</strong> (screenshot/receipt).
          </li>
          <li>
            <strong>Submission:</strong> Booking is created with status
            <code>Pending</code>.
          </li>
        </ol>
      </li>
    </ul>
    <h4>Phase 3: Confirmation & Service</h4>
    <ul>
      <li><strong>User Expectation:</strong> Confirmation of their slot.</li>
      <li>
        <strong>Process:</strong>
        <ol>
          <li>
            <strong>Admin Review:</strong> Admin verifies the payment proof in
            the dashboard.
          </li>
          <li>
            <strong>Approval:</strong> Admin changes status to
            <code>Confirmed</code>.
          </li>
          <li>
            <strong>Notification:</strong> User sees the status change in their
            "My Appointments" tab. The date is now fully blocked on the public
            calendar.
          </li>
          <li>
            <strong>Invoicing:</strong> User can download a generated
            <strong>PDF Invoice</strong> for their records.
          </li>
        </ol>
      </li>
    </ul>
    <h4>Phase 4: Delivery & Completion</h4>
    <ul>
      <li><strong>User Goal:</strong> Receive photos and finalize payment.</li>
      <li>
        <strong>Process:</strong>
        <ol>
          <li>
            <strong>Post-Production:</strong> After the event, Admin updates
            status to <code>Post-Production</code>.
          </li>
          <li>
            <strong>Delivery:</strong> Admin adds a
            <strong>Google Drive Link</strong> to the booking record.
          </li>
          <li>
            <strong>Balance Payment:</strong> User pays the remaining balance.
            Admin marks the booking as <strong>"Fully Paid"</strong>.
          </li>
          <li>
            <strong>Completion:</strong> Admin marks status as
            <code>Completed</code>.
          </li>
          <li>
            <strong>Review:</strong> User leaves a star rating and review, which
            (once approved) appears on the public site.
          </li>
        </ol>
      </li>
    </ul>
    <div class="page-break"></div>
    <h2 id="admin-journey">3. The Admin Journey</h2>
    <p>The Admin Panel is the command center for the business.</p>
    <ol>
      <li>
        <strong>Dashboard:</strong> Real-time overview of Revenue, Upcoming
        Events, and Recent Activity.
      </li>
      <li>
        <strong>Calendar:</strong> Visual view of all bookings (Color-coded:
        Gold=Pending, Green=Confirmed).
      </li>
      <li>
        <strong>Booking Management:</strong>
        <ul>
          <li>View detailed booking info.</li>
          <li><strong>Action:</strong> Approve/Reject bookings.</li>
          <li><strong>Action:</strong> Mark balances as paid.</li>
          <li><strong>Action:</strong> Add admin notes.</li>
        </ul>
      </li>
      <li>
        <strong>Refund Management:</strong>
        <ul>
          <li>View auto-generated refund requests from cancellations.</li>
          <li>
            <strong>Action:</strong> Approve/Reject refunds. System notifies the
            user.
          </li>
        </ul>
      </li>
      <li>
        <strong>Inquiries:</strong> View and manage messages sent via the
        "Contact Us" form.
      </li>
    </ol>
    <h2 id="improvements">4. Key Features & Recent Improvements</h2>
    <p>
      We have recently completed a <strong>"Fix It All"</strong> phase to ensure
      the system is production-ready.
    </p>
    <h3>âœ… Critical Fixes</h3>
    <ul>
      <li>
        <strong>Case Sensitivity Resolved:</strong> Fixed bugs where "Pending"
        vs "pending" caused reviews to fail, calendar colors to break, and
        dashboard counts to be wrong.
      </li>
      <li>
        <strong>Dynamic Data:</strong> The Admin Calendar and Inquiries page now
        fetch real-time data correctly.
      </li>
    </ul>
    <h3>ðŸš€ New Features Implemented</h3>
    <ul>
      <li>
        <strong>Refund System:</strong> Automatic requests on cancellation,
        visible status badges for users, and in-app notifications.
      </li>
      <li>
        <strong>Financial Tracking:</strong> Admins can explicitly mark balances
        as paid. Dynamic invoice generation implemented.
      </li>
      <li>
        <strong>Data Integrity:</strong> Successfully migrated legacy contact
        messages to the new <code>inquiries</code> system.
      </li>
    </ul>
    <h2 id="swot">5. SWOT Analysis</h2>
    <h3>ðŸ’ª Strengths</h3>
    <ul>
      <li>
        <strong>Premium UX:</strong> The "Luxury Design System" (Gold/Black
        theme) sets a high-value tone.
      </li>
      <li>
        <strong>Robust Logic:</strong> The "One Booking Per Day" rule prevents
        double-booking conflicts effectively.
      </li>
      <li>
        <strong>Security:</strong> Rate limiting, input sanitization, and secure
        session management are in place.
      </li>
    </ul>
    <h3>ðŸ“‰ Weaknesses</h3>
    <ul>
      <li>
        <strong>Manual Notifications:</strong> Email notifications are currently
        simulated or rely on in-app alerts.
      </li>
      <li>
        <strong>Rigid Scheduling:</strong> The system only supports full-day
        bookings.
      </li>
    </ul>
    <h3>ðŸŒŸ Opportunities</h3>
    <ul>
      <li>
        <strong>Email Automation:</strong> Integrate PHPMailer for real emails.
      </li>
      <li><strong>CRM Expansion:</strong> Build out Client Notes and Tags.</li>
    </ul>
    <div class="page-break"></div>
    <h2 id="architecture">6. System Architecture</h2>
    <p>
      The Aperture system follows a
      <strong>Monolithic Architecture</strong> typical of PHP applications, with
      a clear separation of concerns using a
      <strong>Page-Controller</strong> pattern.
    </p>
    <h3>Core Components</h3>
    <ul>
      <li>
        <strong>Frontend (View):</strong> HTML5, CSS3 (Custom "Luxury Design
        System" + Bootstrap 5), Vanilla JavaScript.
      </li>
      <li><strong>Backend (Controller/Logic):</strong> Native PHP 8.x.</li>
      <li><strong>Database (Model):</strong> MySQL / MariaDB.</li>
      <li><strong>Server:</strong> Apache (XAMPP environment).</li>
    </ul>
    <h3>Directory Structure</h3>
    <pre>
src/
â”œâ”€â”€ admin/              # Admin-facing pages and logic
â”‚   â”œâ”€â”€ api/            # Admin-specific API endpoints
â”‚   â”œâ”€â”€ components/     # Reusable admin UI parts
â”‚   â””â”€â”€ js/             # Admin-specific JavaScript
â”œâ”€â”€ user/               # Client-facing pages and logic
â”‚   â”œâ”€â”€ api/            # Client-specific API endpoints
â”‚   â””â”€â”€ js/             # Client-specific JavaScript
â”œâ”€â”€ includes/           # Shared resources
â”‚   â””â”€â”€ functions/      # Core logic libraries
â”œâ”€â”€ api/                # Public/Shared API endpoints
â”œâ”€â”€ assets/             # Static assets
â””â”€â”€ sql/                # Database migration scripts
    </pre>
    <h2 id="database">7. Database Design</h2>
    <p>
      The database is normalized to 3NF to ensure data integrity. Key entities
      include:
    </p>
    <h3>Core Entities</h3>
    <ul>
      <li>
        <strong>Users:</strong> Stores all accounts (Admin & User). Uses
        <code>Role</code> enum.
      </li>
      <li>
        <strong>Bookings:</strong> The central entity linking
        <code>Users</code> to <code>Packages</code>. Tracks
        <code>event_date</code>, <code>status</code>, and <code>payment</code>.
      </li>
      <li>
        <strong>Packages:</strong> Service definitions with pricing and
        inclusions.
      </li>
    </ul>
    <h3>Supporting Entities</h3>
    <ul>
      <li><strong>Refunds:</strong> Tracks cancellation refund requests.</li>
      <li><strong>Reviews:</strong> Client feedback linked to Bookings.</li>
      <li><strong>Inquiries:</strong> Contact form messages.</li>
      <li><strong>Notifications:</strong> System alerts for users.</li>
      <li><strong>Booking_Logs:</strong> Audit trail for status changes.</li>
    </ul>
    <h2 id="security">8. Security & API</h2>
    <h3>Security Measures</h3>
    <ul>
      <li>
        <strong>Authentication:</strong> Session-based (`session_start`) with
        Bcrypt password hashing.
      </li>
      <li>
        <strong>Authorization:</strong> Role-based access control (RBAC)
        checking `$_SESSION['role']`.
      </li>
      <li>
        <strong>Data Protection:</strong> Prepared statements for SQL injection
        prevention and `htmlspecialchars()` for XSS prevention.
      </li>
    </ul>
    <h3>API Design</h3>
    <p>
      The system uses a REST-like approach for dynamic interactions via
      JSON/AJAX.
    </p>
    <ul>
      <li><code>GET /api/getAppointments.php</code>: Fetch user bookings.</li>
      <li>
        <code>POST /admin/api/manage_booking.php</code>: Update booking status.
      </li>
      <li><code>POST /user/api/reviews_api.php</code>: Submit a review.</li>
    </ul>
  </body>
</html>