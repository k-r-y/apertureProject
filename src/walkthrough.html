<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Comprehensive System Documentation - Aperture Studios</title>
    <link
      rel="stylesheet"
      href="../bootstrap-5.3.8-dist/css/bootstrap.min.css"
    />
    <link
      rel="stylesheet"
      href="../bootstrap-5.3.8-dist/font/bootstrap-icons.css"
    />
    <link rel="stylesheet" href="luxuryDesignSystem.css" />
    <link rel="icon" href="assets/camera.png" type="image/x-icon" />
    <style>
      body {
        background-color: #121212;
        color: #e0e0e0;
        font-family: "Inter", sans-serif;
      }
      .sidebar {
        width: 300px;
        background: #0a0a0a;
        border-right: 1px solid #333;
        height: 100vh;
        position: fixed;
        overflow-y: auto;
        padding-top: 2rem;
      }
      .main-content {
        margin-left: 300px;
        padding: 3rem;
      }
      .nav-link {
        color: #a0a0a0;
        padding: 0.6rem 1.5rem;
        border-left: 3px solid transparent;
        font-size: 0.9rem;
      }
      .nav-link:hover,
      .nav-link.active {
        color: #d4af37;
        background: rgba(212, 175, 55, 0.05);
        border-left-color: #d4af37;
      }
      .nav-group-title {
        color: #666;
        font-size: 0.75rem;
        text-transform: uppercase;
        letter-spacing: 1px;
        padding: 1rem 1.5rem 0.5rem;
        font-weight: 600;
      }
      .section-title {
        color: #d4af37;
        border-bottom: 1px solid #333;
        padding-bottom: 1rem;
        margin-bottom: 2rem;
        margin-top: 4rem;
      }
      .card {
        background: #1a1a1a;
        border: 1px solid #333;
        transition: transform 0.2s;
      }
      .card:hover {
        transform: translateY(-2px);
        border-color: #d4af37;
      }
      code {
        color: #d4af37;
        background: rgba(212, 175, 55, 0.1);
        padding: 2px 4px;
        border-radius: 4px;
      }
      .table-dark {
        --bs-table-bg: #1a1a1a;
        --bs-table-border-color: #333;
      }
      .workflow-step text-light {
        border-left: 2px solid #333;
        padding-left: 1.5rem;
        margin-bottom: 2rem;
        position: relative;
      }
      .workflow-step text-light::before {
        content: "";
        position: absolute;
        left: -7px;
        top: 0;
        width: 12px;
        height: 12px;
        background: #d4af37;
        border-radius: 50%;
      }
    </style>
  </head>
  <body>
    <!-- Sidebar Navigation -->
    <nav class="sidebar">
      <div class="px-4 mb-4">
        <h4 class="text-gold font-serif">Aperture Docs</h4>
        <p class="text-muted small">System V1.0 Documentation</p>
      </div>

      <div class="nav flex-column">
        <div class="nav-group-title">General</div>
        <a href="#overview" class="nav-link active">Overview & Goals</a>
        <a href="#architecture" class="nav-link">System Architecture</a>

        <div class="nav-group-title">Database</div>
        <a href="#schema" class="nav-link">Schema & Tables</a>

        <div class="nav-group-title">Modules</div>
        <a href="#public" class="nav-link">Public Pages</a>
        <a href="#user" class="nav-link">User Portal</a>
        <a href="#admin" class="nav-link">Admin Dashboard</a>

        <div class="nav-group-title">Core Logic</div>
        <a href="#authentication" class="nav-link">Authentication System</a>
        <a href="#helpers" class="nav-link">Helper Functions</a>
        <a href="#api" class="nav-link">API Reference</a>

        <div class="nav-group-title">Team</div>
        <a href="#team-roles" class="nav-link">Role Distribution</a>

        <div class="nav-group-title">Workflows</div>
        <a href="#refund-process" class="nav-link">Refund Process</a>
        <a href="#user-journey" class="nav-link">User Journey</a>
        <a href="#flows" class="nav-link">Process Flows</a>
        <a href="#detailed-specs" class="nav-link">Detailed Specs</a>
        <a href="#improvements" class="nav-link">Improvements</a>
        <a href="#recent-fixes" class="nav-link">Recent Fixes</a>
        <a href="#future" class="nav-link">Future Features</a>
        <a href="#testing-guide" class="nav-link">Testing Guide</a>
        <a href="#interview-guide" class="nav-link">Interview Guide</a>
      </div>
    </nav>

    <!-- Main Content -->
<main class="main-content">
      <!-- Overview -->
      <section id="overview">
        <h1 class="display-4 text-gold font-serif mb-4">
          System Documentation
        </h1>
        <p class="lead text-light">
          A complete technical and functional guide to the Aperture Studios
          Booking & Management System.
        </p>

        <div class="row g-4 mt-4">
          <div class="col-md-6">
            <div class="card p-4 h-100">
              <h5 class="text-gold">Project Goal</h5>
              <p class="text-muted small">
                To replace manual, paper-based, or disjointed digital tools
                (email, spreadsheets) with a unified web application. The goal
                is to automate the booking lifecycle, ensure financial accuracy,
                and provide a premium digital experience that matches the
                studio's brand.
              </p>
            </div>
          </div>
          <div class="col-md-6">
            <div class="card p-4 h-100">
              <h5 class="text-gold">Key Problems Solved</h5>
              <ul class="text-muted small mb-0">
                <li>
                  <strong>Double Booking:</strong> Eliminated via real-time
                  conflict checking.
                </li>
                <li>
                  <strong>Lost Payments:</strong> All transactions
                  (downpayments, balances, refunds) are logged.
                </li>
                <li>
                  <strong>Communication Lag:</strong> Automated status updates
                  reduce manual emails.
                </li>
                <li>
                  <strong>Asset Delivery:</strong> Secure, integrated gallery
                  delivery.
                </li>
              </ul>
            </div>
          </div>
        </div>
      </section>

      <!-- Architecture -->
      <section id="architecture">
        <h2 class="section-title">System Architecture</h2>
        <p class="text-muted">
          The system is built on a standard LAMP stack (Linux/Windows, Apache,
          MySQL, PHP) using a custom MVC-like structure.
        </p>

        <div class="card p-4 mb-4">
          <h5 class="text-gold">Directory Structure</h5>
          <pre class="text-muted small mb-0">
src/
├── admin/                  # Admin Portal (Protected)
│   ├── api/                # Admin-specific AJAX endpoints
│   ├── components/         # Reusable admin UI (Sidebar, Header)
│   ├── js/                 # Admin-specific JavaScript
│   └── *.php               # Admin pages (Dashboard, Bookings, etc.)
├── user/                   # User Portal (Protected)
│   ├── api/                # User-specific AJAX endpoints
│   ├── components/         # Reusable user UI
│   ├── js/                 # User-specific JavaScript
│   └── *.php               # User pages (Dashboard, Appointments, etc.)
├── includes/               # Core Logic
│   └── functions/          # Helper libraries (DB, Auth, Mail, Security)
├── assets/                 # Static resources (Images, CSS)
└── sql/                    # Database migration scripts
          </pre>
        </div>
      </section>

      <!-- API Reference -->
      <section id="api">
        <h2 class="section-title">API Reference</h2>
        <div class="card p-4">
          <h5 class="text-gold">API Endpoints</h5>
          <p class="text-muted small">
            This section is a placeholder for the API reference. Key endpoints like 
            <code>check_availability.php</code>, <code>admin/api/dashboard_stats.php</code>, and 
            <code>settings_api.php</code> should be documented here with their expected parameters and responses.
          </p>
        </div>
      </section>

      <!-- Database Schema -->
      <section id="schema">
        <h2 class="section-title">Database Schema</h2>
        <p class="text-muted">
          The application uses a relational MySQL database. Key tables include:
        </p>

        <!-- ER Diagram -->
        <div class="card p-4 mb-4 bg-dark border-secondary">
          <h5 class="text-warning mb-3">Entity Relationship Diagram (ERD)</h5>

          <pre class="mermaid">
              erDiagram
                  %% Relationships
                  USERS ||--o{ BOOKINGS : "makes"
                  USERS ||--o{ ACTIVITY_LOG : "generates"
                  USERS ||--o{ NOTIFICATIONS : "receives"
                  USERS ||--o{ USER_PHOTOS : "owns"
                  BOOKINGS ||--o{ INVOICES : "generates"
                  BOOKINGS ||--o{ REFUNDS : "triggers"
                  BOOKINGS ||--o{ REVIEWS : "has"
                  BOOKINGS ||--o{ USER_PHOTOS : "contains"
                  PACKAGES ||--o{ BOOKINGS : "defines"

                  %% Main Entities
                  USERS {
                      int userID PK
                      string Email
                      string Role
                      string FullName
                  }

                  BOOKINGS {
                      int bookingID PK
                      int userID FK
                      string packageID FK
                      date event_date
                      string status
                      decimal total_price
                  }

                  INVOICES {
                      int invoiceID PK
                      int bookingID FK
                      decimal amount
                      string status
                  }

                  REFUNDS {
                      int refundID PK
                      int bookingID FK
                      decimal amount
                      string status
                  }

                  PACKAGES {
                      string packageID PK
                      string packageName
                      decimal Price
                  }

                  INQUIRIES {
                      int id PK
                      string email
                      string subject
                  }

                  SETTINGS {
                      string setting_key PK
                      string setting_value
                  }

                  %% Missing Entities (Defined for completeness)
                  ACTIVITY_LOG {
                      int logID PK
                      int userID FK
                      string action
                  }

                  NOTIFICATIONS {
                      int notifID PK
                      int userID FK
                      string message
                  }

                  USER_PHOTOS {
                      int photoID PK
                      int userID FK
                      string file_path
                  }

                  REVIEWS {
                      int reviewID PK
                      int bookingID FK
                      int rating
                  }
              </pre>
    
        </div>

        <div class="table-responsive">
          <table class="table table-dark table-hover border-secondary">
            <thead>
              <tr>
                <th class="text-gold">Table</th>
                <th class="text-gold">Description</th>
                <th class="text-gold">Key Columns</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td><code>addons</code></td>
                <td>Package add-ons and extras.</td>
                <td>
                  <code>addID</code> (int, PK),
                  <code>packageID</code> (varchar),
                  <code>Description</code> (varchar),
                  <code>Price</code> (decimal)
                </td>
              </tr>
              <tr>
                <td><code>api_rate_limit</code></td>
                <td>API throttling tracker.</td>
                <td>
                  <code>id</code> (int, PK), <code>identifier</code> (varchar),
                  <code>endpoint</code> (varchar),
                  <code>request_count</code> (int),
                  <code>window_start</code> (datetime)
                </td>
              </tr>
              <tr>
                <td><code>booking_logs</code></td>
                <td>Audit trail for booking actions.</td>
                <td>
                  <code>logID</code> (int, PK), <code>bookingID</code> (int),
                  <code>userID</code> (int), <code>action</code> (varchar),
                  <code>details</code> (text),
                  <code>created_at</code> (timestamp)
                </td>
              </tr>
              <tr>
                <td><code>bookings</code></td>
                <td>Core booking records.</td>
                <td>
                  <code>bookingID</code> (int, PK), <code>userID</code> (int),
                  <code>packageID</code> (varchar),
                  <code>event_date</code> (date),
                  <code>total_amount</code> (decimal),
                  <code>booking_status</code> (enum),
                  <code>payment_status</code> (varchar),
                  <code>created_at</code> (timestamp) <br /><small
                    class="text-muted"
                    >...and 20+ other fields</small
                  >
                </td>
              </tr>
              <tr>
                <td><code>client_notes</code></td>
                <td>Admin notes on clients.</td>
                <td>
                  <code>noteID</code> (int, PK), <code>userID</code> (int),
                  <code>adminID</code> (int), <code>note</code> (text)
                </td>
              </tr>
              <tr>
                <td><code>contactmessages</code></td>
                <td>Public contact form submissions.</td>
                <td>
                  <code>id</code> (int, PK), <code>name</code> (varchar),
                  <code>email</code> (varchar), <code>subject</code> (varchar),
                  <code>message</code> (text), <code>is_read</code> (tinyint)
                </td>
              </tr>
              <tr>
                <td><code>inquiries</code></td>
                <td>General inquiries.</td>
                <td>
                  <code>id</code> (int, PK), <code>name</code> (varchar),
                  <code>email</code> (varchar), <code>subject</code> (varchar),
                  <code>message</code> (text), <code>status</code> (enum)
                </td>
              </tr>
              <tr>
                <td><code>invoices</code></td>
                <td>Payment records.</td>
                <td>
                  <code>invoiceID</code> (int, PK),
                  <code>bookingID</code> (int), <code>issue_date</code> (date),
                  <code>due_date</code> (date), <code>status</code> (enum)
                </td>
              </tr>
              <tr>
                <td><code>notifications</code></td>
                <td>System alerts.</td>
                <td>
                  <code>notificationID</code> (int, PK),
                  <code>userID</code> (int), <code>type</code> (varchar),
                  <code>message</code> (text), <code>is_read</code> (tinyint)
                </td>
              </tr>
              <tr>
                <td><code>packages</code></td>
                <td>Service packages.</td>
                <td>
                  <code>packageID</code> (varchar, PK),
                  <code>packageName</code> (varchar),
                  <code>Price</code> (decimal), <code>description</code> (text)
                </td>
              </tr>
              <tr>
                <td><code>refunds</code></td>
                <td>Refund requests and processing.</td>
                <td>
                  <code>refundID</code> (int, PK), <code>bookingID</code> (int),
                  <code>amount</code> (decimal), <code>status</code> (enum),
                  <code>reason</code> (varchar)
                </td>
              </tr>
              <tr>
                <td><code>reviews</code></td>
                <td>Client feedback.</td>
                <td>
                  <code>reviewID</code> (int, PK), <code>bookingID</code> (int),
                  <code>rating</code> (int), <code>comment</code> (text),
                  <code>status</code> (enum)
                </td>
              </tr>
              <tr>
                <td><code>settings</code></td>
                <td>System configuration.</td>
                <td>
                  <code>setting_key</code> (varchar, PK),
                  <code>setting_value</code> (text),
                  <code>updated_at</code> (timestamp)
                </td>
              </tr>
              <tr>
                <td><code>user_activity_log</code></td>
                <td>User action history.</td>
                <td>
                  <code>activity_id</code> (int, PK),
                  <code>user_id</code> (int), <code>activity_type</code> (enum),
                  <code>activity_description</code> (text)
                </td>
              </tr>
              <tr>
                <td><code>user_photos</code></td>
                <td>Gallery photos.</td>
                <td>
                  <code>photoID</code> (int, PK), <code>userID</code> (int),
                  <code>fileName</code> (varchar), <code>bookingID</code> (int),
                  <code>photo_type</code> (enum)
                </td>
              </tr>
              <tr>
                <td><code>users</code></td>
                <td>All registered users.</td>
                <td>
                  <code>userID</code> (int, PK), <code>Email</code> (varchar),
                  <code>Role</code> (enum), <code>FullName</code> (varchar),
                  <code>isVerified</code> (tinyint), <code>Status</code> (enum)
                </td>
              </tr>
              <tr>
                <td><code>booking_logs_archive</code></td>
                <td>Archived booking logs.</td>
                <td>
                  <code>logID</code> (int, PK), <code>bookingID</code> (int),
                  <code>Action</code> (varchar),
                  <code>archivedAt</code> (datetime)
                </td>
              </tr>
              <tr>
                <td><code>bookings_archive</code></td>
                <td>Archived bookings.</td>
                <td>
                  <code>bookingID</code> (int, PK), <code>userID</code> (int),
                  <code>BookingStatus</code> (varchar),
                  <code>archivedAt</code> (datetime)
                </td>
              </tr>
              <tr>
                <td><code>client_tags</code></td>
                <td>Tags for client categorization.</td>
                <td>
                  <code>tagID</code> (int, PK), <code>tag_name</code> (varchar),
                  <code>tag_color</code> (varchar)
                </td>
              </tr>
              <tr>
                <td><code>communication_log</code></td>
                <td>History of communications.</td>
                <td>
                  <code>logID</code> (int, PK), <code>userID</code> (int),
                  <code>type</code> (enum), <code>notes</code> (text)
                </td>
              </tr>
              <tr>
                <td><code>inclusion</code></td>
                <td>Package inclusions.</td>
                <td>
                  <code>inclusionID</code> (int, PK),
                  <code>packageID</code> (varchar),
                  <code>Description</code> (varchar)
                </td>
              </tr>
              <tr>
                <td><code>password_history</code></td>
                <td>Previous passwords for security.</td>
                <td>
                  <code>id</code> (int, PK), <code>userID</code> (int),
                  <code>password_hash</code> (varchar)
                </td>
              </tr>
              <tr>
                <td><code>ratelimiting</code></td>
                <td>Login attempt tracking.</td>
                <td>
                  <code>id</code> (int, PK), <code>userID</code> (int),
                  <code>logInAttempt</code> (int),
                  <code>loginLocked</code> (timestamp)
                </td>
              </tr>
              <tr>
                <td><code>tags</code></td>
                <td>General system tags.</td>
                <td>
                  <code>tagID</code> (int, PK), <code>tag_name</code> (varchar),
                  <code>tag_color</code> (varchar)
                </td>
              </tr>
              <tr>
                <td><code>user_tags</code></td>
                <td>Tags assigned to users.</td>
                <td>
                  <code>userID</code> (int, PK), <code>tagID</code> (int, PK),
                  <code>assigned_by</code> (int)
                </td>
              </tr>
            </tbody>
          </table>
        </div>
      </section>

      <!-- Public Module -->
      <section id="public" class="mb-5">
        <h2 class="section-title text-gold serif">Public Pages</h2>
        <p class="text-muted mb-4">Overview of public-facing pages accessible to all visitors.</p>
        <div class="table-responsive">
          <table class="table table-dark table-hover border-secondary">
            <thead>
              <tr>
                <th class="text-gold">Page</th>
                <th class="text-gold">Purpose</th>
                <th class="text-gold">Key Features</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td><code>index.php</code></td>
                <td>Landing Page</td>
                <td>Hero section, featured content, introduction to services.</td>
              </tr>
              <tr>
                <td><code>services.php</code></td>
                <td>Services Listing</td>
                <td>Displays available photography packages and services.</td>
              </tr>
              <tr>
                <td><code>aboutCompany.php</code></td>
                <td>Company Info</td>
                <td>Mission, values, story. Includes "Contact Us" form (PHPMailer).</td>
              </tr>
              <tr>
                <td><code>aboutUs.php</code></td>
                <td>Team Profiles</td>
                <td>Dynamic team member profiles via <code>?member=name</code>.</td>
              </tr>
              <tr>
                <td><code>register.php</code></td>
                <td>Registration</td>
                <td>User account creation, email verification (OTP), CSRF protection.</td>
              </tr>
              <tr>
                <td><code>logIn.php</code></td>
                <td>Authentication</td>
                <td>User login, account lockout logic, password reset flow.</td>
              </tr>
            </tbody>
          </table>
        </div>
      </section>

      <!-- User Portal -->
      <section id="user" class="mb-5">
        <h2 class="section-title text-gold serif">User Portal</h2>
        <p class="text-muted mb-4">Private dashboard and management tools for registered clients.</p>
        <div class="table-responsive">
          <table class="table table-dark table-hover border-secondary">
            <thead>
              <tr>
                <th class="text-gold">Page</th>
                <th class="text-gold">Purpose</th>
                <th class="text-gold">Key Features</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td><code>user.php</code></td>
                <td>Dashboard</td>
                <td>KPIs (Upcoming Events, Total Bookings, Total Spent), ApexCharts.</td>
              </tr>
              <tr>
                <td><code>appointments.php</code></td>
                <td>Booking Management</td>
                <td>List bookings, filter by status, view details modal, pay balance.</td>
              </tr>
              <tr>
                <td><code>myPhotos.php</code></td>
                <td>Gallery</td>
                <td>View uploaded event photos, filter by event, Google Drive link access.</td>
              </tr>
              <tr>
                <td><code>profile.php</code></td>
                <td>Profile Settings</td>
                <td>Update personal info, change password, request account deletion.</td>
              </tr>
              <tr>
                <td><code>billing.php</code></td>
                <td>Financial History</td>
                <td>View invoices, payment history, download PDF invoices.</td>
              </tr>
            </tbody>
          </table>
        </div>
      </section>

      <!-- Admin Portal -->
      <section id="admin" class="mb-5">
        <h2 class="section-title text-gold serif">Admin Dashboard</h2>
        <p class="text-muted mb-4">Comprehensive management interface for administrators.</p>
        <div class="table-responsive">
          <table class="table table-dark table-hover border-secondary">
            <thead>
              <tr>
                <th class="text-gold">Page</th>
                <th class="text-gold">Purpose</th>
                <th class="text-gold">Key Features</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td><code>adminDashboard.php</code></td>
                <td>Analytics</td>
                <td>Revenue charts, booking statistics, time filtering (Today/Week/Month/Quarter/Year/All Time), action center for pending items.</td>
              </tr>
              <tr>
                <td><code>bookings.php</code></td>
                <td>Booking Management</td>
                <td>CRUD operations for bookings, status updates, meeting link management.</td>
              </tr>
              <tr>
                <td><code>calendar.php</code></td>
                <td>Schedule</td>
                <td>FullCalendar view of all bookings, interactive event details.</td>
              </tr>
              <tr>
                <td><code>client.php</code></td>
                <td>User Management</td>
                <td>Client directory, toggle user status, view client details.</td>
              </tr>
              <tr>
                <td><code>inquiries.php</code></td>
                <td>Communications</td>
                <td>View/Reply to contact form messages, view user activity logs.</td>
              </tr>
              <tr>
                <td><code>invoicing.php</code></td>
                <td>Financials</td>
                <td>Transaction history (payments, refunds), proof of payment verification.</td>
              </tr>
              <tr>
                <td><code>photoUpload.php</code></td>
                <td>Delivery</td>
                <td>Upload photos to specific user galleries, set Google Drive links.</td>
              </tr>
              <tr>
                <td><code>refunds.php</code></td>
                <td>Refund Processing</td>
                <td>Manage cancellation refund requests, approve/reject/process refunds.</td>
              </tr>
              <tr>
                <td><code>reviews.php</code></td>
                <td>Moderation</td>
                <td>Approve or reject user-submitted reviews.</td>
              </tr>
              <tr>
                <td><code>serviceAndPackages.php</code></td>
                <td>Content Management</td>
                <td>Edit package prices, descriptions, and inclusions.</td>
              </tr>
              <tr>
                <td><code>settings.php</code></td>
                <td>System Config</td>
                <td>Update site name, contact info, admin password.</td>
              </tr>
            </tbody>
          </table>
        </div>
      </section>

      <!-- Detailed Process Specifications -->
      <section id="detailed-specs" class="mb-5">
        <h2 class="section-title text-gold serif">Detailed Process Specifications</h2>
        <p class="text-muted mb-4">
          Comprehensive breakdown of field validations, conditions, and correct inputs for all system forms.
        </p>

        <!-- Authentication Module -->
        <h4 class="text-light mb-3">1. Authentication Module</h4>
        <div class="table-responsive mb-4">
            <table class="table table-dark table-hover border-secondary">
                <thead>
                    <tr>
                        <th class="text-gold">Form</th>
                        <th class="text-gold">Field</th>
                        <th class="text-gold">Condition/Validation Rule</th>
                        <th class="text-gold">Correct Input Example</th>
                    </tr>
                </thead>
                <tbody>
                    <!-- Registration -->
                    <tr>
                        <td rowspan="5" class="align-middle">Registration</td>
                        <td>Email</td>
                        <td>Required; Valid email format; Unique (not already registered).</td>
                        <td><code>user@example.com</code></td>
                    </tr>
                    <tr>
                        <td>Password</td>
                        <td>Required; Min 8 characters.</td>
                        <td><code>Password123!</code></td>
                    </tr>
                    <tr>
                        <td>Confirm Password</td>
                        <td>Required; Must match Password exactly.</td>
                        <td><code>Password123!</code></td>
                    </tr>
                    <tr>
                        <td>Terms Check</td>
                        <td>Required; Must be checked.</td>
                        <td><code>Checked</code></td>
                    </tr>
                    <tr>
                        <td>Verification Code</td>
                        <td>Required; Exactly 6 digits; Must match sent code.</td>
                        <td><code>123456</code></td>
                    </tr>
                    <!-- Login -->
                    <tr>
                        <td rowspan="2" class="align-middle">Login</td>
                        <td>Email</td>
                        <td>Required; Valid email format.</td>
                        <td><code>user@example.com</code></td>
                    </tr>
                    <tr>
                        <td>Password</td>
                        <td>Required.</td>
                        <td><code>Password123!</code></td>
                    </tr>
                    <!-- Profile Completion -->
                    <tr>
                        <td rowspan="3" class="align-middle">Profile Completion</td>
                        <td>First Name</td>
                        <td>Required.</td>
                        <td><code>Juan</code></td>
                    </tr>
                    <tr>
                        <td>Last Name</td>
                        <td>Required.</td>
                        <td><code>Dela Cruz</code></td>
                    </tr>
                    <tr>
                        <td>Contact No.</td>
                        <td>Required; 11 digits; Must start with '09'; Numeric only.</td>
                        <td><code>09171234567</code></td>
                    </tr>
                </tbody>
            </table>
        </div>

        <!-- Booking Process -->
        <h4 class="text-light mb-3">2. Booking Process</h4>
        <div class="table-responsive mb-4">
            <table class="table table-dark table-hover border-secondary">
                <thead>
                    <tr>
                        <th class="text-gold">Section</th>
                        <th class="text-gold">Field</th>
                        <th class="text-gold">Condition/Validation Rule</th>
                        <th class="text-gold">Correct Input Example</th>
                    </tr>
                </thead>
                <tbody>
                    <!-- Event Details -->
                    <tr>
                        <td rowspan="5" class="align-middle">Event Details</td>
                        <td>Event Date</td>
                        <td>Required; Minimum 3 days in advance; Maximum 3 years in advance.</td>
                        <td><code>2025-12-01</code></td>
                    </tr>
                    <tr>
                        <td>Event Type</td>
                        <td>Required; Selection from list. If "Other", text input required.</td>
                        <td><code>Wedding</code></td>
                    </tr>
                    <tr>
                        <td>Start Time</td>
                        <td>Required; 07:00 AM - 10:00 PM range.</td>
                        <td><code>09:00 AM</code></td>
                    </tr>
                    <tr>
                        <td>End Time</td>
                        <td>Required; Must be after Start Time.</td>
                        <td><code>05:00 PM</code></td>
                    </tr>
                    <tr>
                        <td>Location</td>
                        <td>Required; Text address.</td>
                        <td><code>123 Main St, City</code></td>
                    </tr>
                    <!-- Consultation -->
                    <tr>
                        <td rowspan="3" class="align-middle">Consultation</td>
                        <td>Date</td>
                        <td>Required; Must be a future date.</td>
                        <td><code>2025-11-30</code></td>
                    </tr>
                    <tr>
                        <td>Start Time</td>
                        <td>Required; 09:00 AM - 06:00 PM range.</td>
                        <td><code>10:00 AM</code></td>
                    </tr>
                    <tr>
                        <td>End Time</td>
                        <td>Required; Min 30 mins, Max 1.5 hours duration from Start Time.</td>
                        <td><code>11:00 AM</code></td>
                    </tr>
                    <!-- Payment -->
                    <tr>
                        <td rowspan="3" class="align-middle">Payment</td>
                        <td>Payment Method</td>
                        <td>Required (GCash, PayMaya, Bank, Cash).</td>
                        <td><code>GCash</code></td>
                    </tr>
                    <tr>
                        <td>Proof of Payment</td>
                        <td>Required (unless Cash); Max 5MB; JPG, PNG, PDF.</td>
                        <td><code>receipt.jpg</code></td>
                    </tr>
                    <tr>
                        <td>Downpayment</td>
                        <td>Required; Minimum 25% of Total Price; Max Total Price.</td>
                        <td><code>5000</code></td>
                    </tr>
                    <!-- Agreements -->
                    <tr>
                        <td class="align-middle">Agreements</td>
                        <td>Terms Check</td>
                        <td>Required; Must be checked.</td>
                        <td><code>Checked</code></td>
                    </tr>
                </tbody>
            </table>
        </div>

        <!-- Refund & Cancellation Logic -->
        <h4 class="text-light mb-3">3. Refund & Cancellation Logic</h4>
        <div class="card bg-dark border-secondary mb-4">
            <div class="card-body">
                <div class="row g-4">
                    <div class="col-md-6">
                        <h6 class="text-gold">User Cancellation</h6>
                        <ul class="text-muted small">
                            <li><strong>Allowed Status:</strong> <code>pending_consultation</code>, <code>confirmed</code>.</li>
                            <li><strong>Refund Amount:</strong> <span class="text-success">40%</span> of Downpayment returned to User.</li>
                            <li><strong>Cancellation Fee:</strong> <span class="text-danger">60%</span> of Downpayment retained by Admin.</li>
                        </ul>
                    </div>
                    <div class="col-md-6">
                        <h6 class="text-gold">Admin Refund Process</h6>
                        <ul class="text-muted small">
                            <li><strong>Step 1:</strong> Admin reviews request in Dashboard.</li>
                            <li><strong>Step 2:</strong> Sets status to <code>Approved</code> or <code>Rejected</code>.</li>
                            <li><strong>Step 3:</strong> If Approved, Admin processes payment manually.</li>
                            <li><strong>Step 4:</strong> Admin uploads proof of refund and sets status to <code>Processed</code>.</li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>
      </section>

      <!-- Refund Process -->
      <section id="refund-process" class="mb-5">
        <h2 class="section-title text-gold serif">Refund Process</h2>
        <p class="text-muted mb-4">
          The system implements a strict refund policy for cancellations. This process is automated upon user cancellation.
        </p>

        <div class="card bg-dark border-secondary mb-4">
          <div class="card-body">
            <h5 class="text-gold mb-3">Cancellation & Refund Logic</h5>
            <div class="row g-4">
              <div class="col-md-6">
                <h6 class="text-light">1. Eligibility</h6>
                <ul class="text-muted small">
                  <li>User can only cancel bookings with status: <code>pending_consultation</code> or <code>confirmed</code>.</li>
                  <li>Completed or already cancelled bookings cannot be modified by the user.</li>
                </ul>
              </div>
              <div class="col-md-6">
                <h6 class="text-light">2. Calculation</h6>
                <ul class="text-muted small">
                  <li><strong>Total Downpayment:</strong> The amount paid upfront (25% of package).</li>
                  <li><strong>Refund Amount:</strong> <span class="text-success">40%</span> of the downpayment.</li>
                  <li><strong>Cancellation Fee:</strong> <span class="text-danger">60%</span> of the downpayment (Retained by Admin).</li>
                </ul>
              </div>
            </div>
            <hr class="border-secondary">
            <h6 class="text-light">3. Process Flow</h6>
            <ol class="text-muted small">
              <li>User clicks <strong>"Cancel Booking"</strong> in <em>My Appointments</em>.</li>
              <li>System checks eligibility and calculates amounts.</li>
              <li>Booking status updates to <code>cancelled</code>.</li>
              <li>A new record is inserted into the <code>refunds</code> table with status <code>pending</code>.</li>
              <li>User receives a notification detailing the refund amount and fee.</li>
            </ol>
          </div>
        </div>
      </section>

      <!-- User Journey: Account to Photos -->
      <section id="user-journey" class="mb-5">
        <h2 class="section-title text-gold serif">User Journey: From Sign-up to Photos</h2>
        <p class="text-muted mb-4">
          A complete walkthrough of the client lifecycle, from account creation to receiving their final edited photos.
        </p>

        <div class="timeline">
          <!-- Step 1 -->
          <div class="card bg-dark border-secondary mb-3">
            <div class="card-body">
              <div class="d-flex align-items-center mb-2">
                <span class="badge bg-gold text-dark me-2">1</span>
                <h5 class="card-title text-light m-0">Account Creation</h5>
              </div>
              <p class="card-text text-muted small">
                User visits <code>register.php</code> and enters Email, Password, and confirms via a 6-digit email code.
                <br><strong>Status:</strong> Account Created, Unverified -> Verified.
              </p>
            </div>
          </div>

          <!-- Step 2 -->
          <div class="card bg-dark border-secondary mb-3">
            <div class="card-body">
              <div class="d-flex align-items-center mb-2">
                <span class="badge bg-gold text-dark me-2">2</span>
                <h5 class="card-title text-light m-0">Profile Completion</h5>
              </div>
              <p class="card-text text-muted small">
                Upon first login, user is redirected to <code>completeProfile.php</code>.
                <br><strong>Required:</strong> First Name, Last Name, Valid Contact No. (09xxxxxxxxx).
                <br><strong>Gatekeeper:</strong> User cannot book or browse until this is done.
              </p>
            </div>
          </div>

          <!-- Step 3 -->
          <div class="card bg-dark border-secondary mb-3">
            <div class="card-body">
              <div class="d-flex align-items-center mb-2">
                <span class="badge bg-gold text-dark me-2">3</span>
                <h5 class="card-title text-light m-0">Booking & Downpayment</h5>
              </div>
              <p class="card-text text-muted small">
                User selects Package, Date, and Time in <code>bookingForm.php</code>.
                <br><strong>Action:</strong> Uploads proof of payment for the required downpayment.
                <br><strong>System:</strong> Creates Booking (Pending) and Transaction record.
              </p>
            </div>
          </div>

          <!-- Step 4 -->
          <div class="card bg-dark border-secondary mb-3">
            <div class="card-body">
              <div class="d-flex align-items-center mb-2">
                <span class="badge bg-gold text-dark me-2">4</span>
                <h5 class="card-title text-light m-0">Admin Confirmation</h5>
              </div>
              <p class="card-text text-muted small">
                Admin reviews payment in <code>admin/bookings.php</code>.
                <br><strong>Action:</strong> Admin checks "Downpayment Confirmed".
                <br><strong>Status:</strong> Booking becomes <code>Confirmed</code>. User notified.
              </p>
            </div>
          </div>

          <!-- Step 5 -->
          <div class="card bg-dark border-secondary mb-3">
            <div class="card-body">
              <div class="d-flex align-items-center mb-2">
                <span class="badge bg-gold text-dark me-2">5</span>
                <h5 class="card-title text-light m-0">Event & Final Payment</h5>
              </div>
              <p class="card-text text-muted small">
                After the event, user pays the remaining balance via <em>My Appointments</em>.
                <br><strong>Action:</strong> User uploads final payment proof.
                <br><strong>Admin:</strong> Confirms final payment. Status -> <code>Completed</code> (or Post-Production).
              </p>
            </div>
          </div>

          <!-- Step 6 -->
          <div class="card bg-dark border-secondary mb-3">
            <div class="card-body">
              <div class="d-flex align-items-center mb-2">
                <span class="badge bg-gold text-dark me-2">6</span>
                <h5 class="card-title text-light m-0">Photo Delivery</h5>
              </div>
              <p class="card-text text-muted small">
                Admin goes to <code>admin/photoUpload.php</code>.
                <br><strong>Action:</strong> Selects the completed booking. Uploads photos (JPG/PNG) OR provides a Google Drive link.
                <br><strong>System:</strong> Files stored in <code>uploads/user_photos/{userID}/</code>.
              </p>
            </div>
          </div>

          <!-- Step 7 -->
          <div class="card bg-dark border-secondary mb-3">
            <div class="card-body">
              <div class="d-flex align-items-center mb-2">
                <span class="badge bg-gold text-dark me-2">7</span>
                <h5 class="card-title text-light m-0">Accessing Photos</h5>
              </div>
              <p class="card-text text-muted small">
                User visits <code>myPhotos.php</code>.
                <br><strong>Result:</strong> Views gallery of uploaded photos or clicks the provided Google Drive link to download assets.
              </p>
            </div>
          </div>
        </div>
      </section>

      <!-- Public Module -->
      <section id="public">
        <h2 class="section-title">Public Module</h2>
        <p class="text-muted">Accessible to unauthenticated visitors.</p>

        <div class="accordion" id="publicAccordion">
          <div class="accordion-item bg-dark border-secondary">
            <h2 class="accordion-header">
              <button
                class="accordion-button bg-dark text-gold"
                type="button"
                data-bs-toggle="collapse"
                data-bs-target="#pubHome"
              >
                Landing Pages
              </button>
            </h2>
            <div
              id="pubHome"
              class="accordion-collapse collapse show"
              data-bs-parent="#publicAccordion"
            >
              <div class="accordion-body text-light">
                <ul class="list-unstyled">
                  <li class="mb-3">
                    <strong class="text-gold">index.php (Home)</strong>
                    <br /><small class="text-muted"
                      >Hero section, featured portfolio carousel, and "Book Now"
                      CTA.</small
                    >
                  </li>
                  <li class="mb-3">
                    <strong class="text-gold">services.php</strong>
                    <br /><small class="text-muted"
                      >Displays packages (Wedding, Portrait, Event) fetched from
                      static arrays or DB configuration.</small
                    >
                  </li>
                  <li class="mb-3">
                    <strong class="text-gold">contact.php</strong>
                    <br /><small class="text-muted">
                      <strong>Form:</strong> Name, Email, Subject, Message.
                      <br /><strong>Action:</strong> Submits to DB
                      <code>inquiries</code> table via POST. <br /><strong
                        >Validation:</strong
                      >
                      HTML5 required attributes + PHP-side email validation.
                    </small>
                  </li>
                </ul>
              </div>
        </div>
      </section>

      <!-- User Module -->
      <section id="user">
        <h2 class="section-title">User Portal</h2>
        <p class="text-muted">
          Protected area for clients. Requires <code>role='User'</code>.
        </p>

        <div class="card p-4 mb-4">
          <h5 class="text-gold">New Booking (bookingForm.php)</h5>
          <p class="text-muted small">The core feature for clients.</p>
          <ul class="text-muted small">
            <li>
              <strong>Date Selection:</strong> Uses a custom calendar UI. Blocks
              past dates.
            </li>
            <li>
              <strong>Time Slots:</strong> Dynamic generation. Checks
              <code>bookings</code> table via AJAX
              (<code>check_availability.php</code>) to disable taken slots.
            </li>
            <li>
              <strong>Cost Logic:</strong> JS calculates
              <code>Total = Package Price + Add-ons</code>.
            </li>
            <li><strong>Downpayment:</strong> Enforces minimum 25% payment.</li>
            <li>
              <strong>Submission:</strong> Uploads proof to server, inserts
              record into <code>bookings</code> and <code>transactions</code>.
            </li>
          </ul>
        </div>

        <div class="card p-4 mb-4">
          <h5 class="text-gold">My Appointments (appointments.php)</h5>
          <p class="text-muted small">
            Management interface for existing bookings.
          </p>
          <ul class="text-muted small">
            <li>
              <strong>Status Badges:</strong> Visual indicators (Pending,
              Confirmed, Completed, Cancelled).
            </li>
            <li>
              <strong>Pay Balance:</strong> Modal to upload final payment proof.
              Only available if <code>balance > 0</code>.
            </li>
            <li>
              <strong>Cancel:</strong> Soft-deletes booking
              (status='Cancelled'). Triggers refund entry if payments exist.
        </div>
      </section>

      <!-- Admin Module -->
      <section id="admin">
        <h2 class="section-title">Admin Dashboard</h2>
        <p class="text-muted">
          Protected area for staff. Requires <code>role='Admin'</code>.
        </p>

        <div class="accordion" id="adminAccordion">
          <div class="accordion-item bg-dark border-secondary">
            <h2 class="accordion-header">
              <button
                class="accordion-button bg-dark text-gold"
                type="button"
                data-bs-toggle="collapse"
                data-bs-target="#admDash"
              >
                Dashboard (adminDashboard.php)
              </button>
            </h2>
            <div
              id="admDash"
              class="accordion-collapse collapse show"
              data-bs-parent="#adminAccordion"
            >
              <div class="accordion-body text-light">
                <ul class="small text-muted">
                  <li>
                    <strong>KPI Cards:</strong> PHP queries count rows in
                    <code>bookings</code> and sum <code>amount</code> in
                    <code>transactions</code>.
                  </li>
                  <li>
                    <strong>Charts:</strong> Uses Chart.js. Data fetched via
                    <code>admin/api/dashboard_stats.php</code>.
                  </li>
                  <li>
                    <strong>Recent Activity:</strong> Fetches last 5 entries
                    from <code>activity_log</code>.
                  </li>
                </ul>
              </div>
            </div>
          </div>

          <div class="accordion-item bg-dark border-secondary">
            <h2 class="accordion-header">
              <button
                class="accordion-button collapsed bg-dark text-gold"
                type="button"
                data-bs-toggle="collapse"
                data-bs-target="#admBookings"
              >
                Manage Bookings (bookings.php)
              </button>
            </h2>
            <div
              id="admBookings"
              class="accordion-collapse collapse"
              data-bs-parent="#adminAccordion"
            >
              <div class="accordion-body text-light">
                <p class="small text-muted">The most complex admin page.</p>
                <ul class="small text-muted">
                  <li>
                    <strong>Data Table:</strong> Lists all bookings with
                    sort/filter options.
                  </li>
                  <li>
                    <strong>Detail Modal:</strong> Shows User info, Package
                    details, and Payment History.
                  </li>
                  <li>
                    <strong>Payment Confirmation:</strong> <br />Two checkboxes:
                    "Downpayment Paid" and "Final Payment Paid". <br /><strong
                      >Logic:</strong
                    >
                    Toggling these updates the <code>bookings</code> table
                    columns <code>downpayment_paid</code> /
                    <code>final_payment_paid</code> via AJAX. <br /><strong
                      >Automation:</strong
                    >
                    If Downpayment is confirmed -> Status becomes 'Confirmed'.
                  </li>
                </ul>
              </div>
            </div>
          </div>

          <div class="accordion-item bg-dark border-secondary">
            <h2 class="accordion-header">
              <button
                class="accordion-button collapsed bg-dark text-gold"
                type="button"
                data-bs-toggle="collapse"
                data-bs-target="#admSettings"
              >
                Settings (settings.php)
              </button>
            </h2>
            <div
              id="admSettings"
              class="accordion-collapse collapse"
              data-bs-parent="#adminAccordion"
            >
              <div class="accordion-body text-light">
                <p class="small text-muted">
                  Dynamic configuration management.
                </p>
                <ul class="small text-muted">
                  <li>
                    <strong>Storage:</strong> Values stored in
                    <code>settings</code> table (Key-Value pairs).
                  </li>
                  <li>
                    <strong>API:</strong> <code>settings_api.php</code> handles
                    GET (load) and POST (save).
                  </li>
                  <li>
                    <strong>Fields:</strong> Site Name, Contact Info,
                    Maintenance Mode, Admin Password.
                  </li>
                </ul>
              </div>
            </div>
          </div>
        </div>
      </section>

      <!-- Security & Auth -->
      <section id="security">
        <h2 class="section-title">Security & Core Logic</h2>
        <div class="row g-4">
          <div class="col-md-6">
            <div class="card p-4 h-100">
              <h5 class="text-gold">Authentication (auth.php)</h5>
              <ul class="text-muted small">
                <li>
                  <strong>Session Based:</strong> Uses PHP
                  <code>$_SESSION</code> to store User ID and Role.
                </li>
                <li>
                  <strong>Hashing:</strong> Passwords hashed using
                  <code>password_hash()</code> (Bcrypt).
                </li>
                <li>
                  <strong>Role Checks:</strong> Middleware functions like
                  <code>requireAdmin()</code> enforce access control.
                </li>
              </ul>
            </div>
          </div>
          <div class="col-md-6">
            <div class="card p-4 h-100">
              <h5 class="text-gold">Protection Measures</h5>
              <ul class="text-muted small">
                <li>
                  <strong>CSRF (csrf.php):</strong> Token generation and
                  validation on all POST forms.
                </li>
                <li>
                  <strong>Rate Limiting (rate_limit.php):</strong> Throttles API
                  requests to prevent abuse.
                </li>
                <li>
                  <strong>Input Sanitization:</strong> All user inputs are
                  sanitized using <code>htmlspecialchars()</code> and Prepared
                  Statements.
                </li>
              </ul>
            </div>
          </div>
        </div>
      </section>

      <!-- Helper Functions -->
      <section id="helpers">
        <h2 class="section-title">Helper Functions</h2>
        <p class="text-muted">
          Located in <code>src/includes/functions/</code>.
        </p>
        <div class="table-responsive">
          <table class="table table-dark table-hover border-secondary">
            <thead>
              <tr>
                <th class="text-gold">File</th>
                <th class="text-gold">Purpose</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td><code>config.php</code></td>
                <td>
                  DB connection, Environment variables, Error logging setup.
                </td>
              </tr>
              <tr>
                <td><code>booking_logic.php</code></td>
                <td>
                  Calculates revenue, handles status transitions, validates
                  dates.
                </td>
              </tr>
              <tr>
                <td><code>activity_logger.php</code></td>
                <td>
                  Function <code>logActivity($userId, $action, $desc)</code> to
                  record audit trails.
                </td>
              </tr>
              <tr>
                <td><code>notifications.php</code></td>
                <td>Handles creation and fetching of in-app alerts.</td>
              </tr>
              <tr>
                <td><code>email_templates.php</code></td>
                <td>
                  HTML templates for system emails (Welcome, Confirmation,
                  etc.).
                </td>
              </tr>
            </tbody>
          </table>
        </div>
      </section>

      <!-- Process Flows -->
      <section id="flows">
        <h2 class="section-title">Process Flows</h2>

        <div class="card p-4 mb-4">
          <h5 class="text-gold">1. Booking Lifecycle (Detailed)</h5>
          <p class="text-muted small mb-4">
            A step-by-step breakdown of the interaction between the User
            (Client) and the Admin.
          </p>

          <div class="workflow-step text-light">
            <strong class="text-gold">Step 1: User Submission</strong>
            <br />
            <span class="badge bg-secondary mb-2">User Action</span>
            <ul class="text-muted small">
              <li>User navigates to <code>bookingForm.php</code>.</li>
              <li>Selects Date, Time, Package, and Add-ons.</li>
              <li>
                Uploads <strong>Proof of Payment</strong> (screenshot/receipt)
                for the downpayment.
              </li>
              <li>Submits the form.</li>
            </ul>
            <span class="badge bg-dark border border-secondary"
              >System Action</span
            >
            <ul class="text-muted small">
              <li>
                Creates a new booking record with status <code>Pending</code>.
              </li>
              <li>Calculates totals and saves file path.</li>
              <li>Sends "Booking Received" email to User.</li>
            </ul>
          </div>

          <div class="workflow-step text-light">
            <strong class="text-gold">Step 2: Admin Verification</strong>
            <br />
            <span class="badge bg-warning text-dark mb-2">Admin Action</span>
            <ul class="text-muted small">
              <li>
                Admin logs in and checks <strong>Manage Bookings</strong>.
              </li>
              <li>Opens the "Pending" booking details.</li>
              <li>Views the uploaded <strong>Proof of Payment</strong>.</li>
              <li>
                Compares the amount in the proof with the required downpayment.
              </li>
            </ul>
          </div>

          <div class="workflow-step text-light">
            <strong class="text-gold">Step 3: Confirmation</strong>
            <br />
            <span class="badge bg-warning text-dark mb-2">Admin Action</span>
            <ul class="text-muted small">
              <li>
                If payment matches, Admin toggles the
                <strong>"Downpayment Paid"</strong> checkbox.
              </li>
              <li>
                System automatically updates status to <code>Confirmed</code>.
              </li>
            </ul>
            <span class="badge bg-dark border border-secondary"
              >System Action</span
            >
            <ul class="text-muted small">
              <li>Generates an Invoice record.</li>
              <li>
                Sends "Booking Confirmed" email to User with meeting
                link/details.
              </li>
            </ul>
          </div>

          <div class="workflow-step text-light">
            <strong class="text-gold">Step 4: Event & Final Payment</strong>
            <br />
            <span class="badge bg-secondary mb-2">User Action</span>
            <ul class="text-muted small">
              <li>
                After the event (or before), User logs in to
                <strong>My Appointments</strong>.
              </li>
              <li>
                Clicks "Pay Balance" and uploads proof for the remaining amount.
              </li>
            </ul>
            <span class="badge bg-warning text-dark mb-2">Admin Action</span>
            <ul class="text-muted small">
              <li>Admin verifies the final payment proof.</li>
              <li>Toggles <strong>"Final Payment Paid"</strong> checkbox.</li>
              <li>
                Marks booking as <code>Completed</code> (after photo delivery).
              </li>
            </ul>
          </div>
        </div>

        <div class="card p-4">
          <h5 class="text-gold">2. Refund Process</h5>
          <div class="workflow-step text-light">
            <strong>Trigger:</strong> Booking is cancelled (by User or Admin).
            <br /><em>System:</em> Checks if payments exist. If yes, creates
            'Refund Request'.
          </div>
          <div class="workflow-step text-light">
            <strong>Processing:</strong> Admin views request in Refunds page.
            <br /><em>Action:</em> Admin processes bank transfer manually.
          </div>
          <div class="workflow-step text-light">
            <strong>Closure:</strong> Admin uploads transfer receipt. <br /><em
              >System:</em
            >
            Marks refund as 'Processed'. Notifies user.
          </div>
        </div>
      </section>

      <!-- System Improvements -->
      <section id="improvements" class="mb-5">
        <h2 class="section-title text-gold serif">System Improvements & Audit</h2>
        <p class="text-muted mb-4">
          Findings from the comprehensive system audit (Nov 2025) and prioritized action plan.
        </p>

        <div class="row g-4 mb-4">
          <!-- Security -->
          <div class="col-md-6">
            <div class="card p-4 h-100 border-danger bg-dark">
              <h5 class="text-danger font-serif">
                <i class="bi bi-shield-exclamation me-2"></i>Security (Critical)
              </h5>
              <ul class="text-muted small mt-3">
                <li class="mb-2">
                  <strong class="text-light">Session Fixation:</strong>
                  Session IDs are not regenerated upon login.
                  <br /><span class="text-danger">Risk: Account Hijacking.</span>
                </li>
                <li class="mb-2">
                  <strong class="text-light">XSS Vulnerability:</strong>
                  <code>inquiries.php</code> renders user input unsafely via innerHTML.
                  <br /><span class="text-danger">Risk: Malicious Script Injection.</span>
                </li>
                <li>
                  <strong class="text-light">CSRF Protection:</strong>
                  Missing in Admin API endpoints (`inquiries_api.php`).
                </li>
              </ul>
            </div>
          </div>

          <!-- Code Quality -->
          <div class="col-md-6">
            <div class="card p-4 h-100 border-warning bg-dark">
              <h5 class="text-warning font-serif">
                <i class="bi bi-code-slash me-2"></i>Code Quality
              </h5>
              <ul class="text-muted small mt-3">
                <li class="mb-2">
                  <strong class="text-light">Refactoring Needed:</strong>
                  <code>auth.php</code> is a "God File" (600+ lines) handling DB, Email, and Auth.
                  <br /><span class="text-warning">Action: Split into `AuthService` and `User` classes.</span>
                </li>
                <li>
                  <strong class="text-light">Spaghetti Code:</strong>
                  <code>processBooking.php</code> mixes validation, pricing, and email logic.
                  <br /><span class="text-warning">Action: Extract `BookingService`.</span>
                </li>
              </ul>
            </div>
          </div>
        </div>

        <div class="row g-4">
          <!-- UI/UX -->
          <div class="col-md-6">
            <div class="card p-4 h-100 border-info bg-dark">
              <h5 class="text-info font-serif">
                <i class="bi bi-palette me-2"></i>UI/UX Standardization
              </h5>
              <ul class="text-muted small mt-3">
                <li class="mb-2">
                  <strong class="text-light">Feedback Systems:</strong>
                  Replace native browser alerts with <strong>SweetAlert2</strong> across all Admin pages.
                </li>
                <li>
                  <strong class="text-light">Loading States:</strong>
                  Implement consistent <code>.luxury-loader</code> for all async operations (Login, Booking).
                </li>
              </ul>
            </div>
          </div>

          <!-- Business Logic -->
          <div class="col-md-6">
            <div class="card p-4 h-100 border-success bg-dark">
              <h5 class="text-success font-serif">
                <i class="bi bi-graph-up-arrow me-2"></i>Business Logic
              </h5>
              <ul class="text-muted small mt-3">
                <li class="mb-2">
                  <strong class="text-light">Consultation Slots:</strong>
                  Add availability check for consultation times to prevent double-booking.
                </li>
                <li>
                  <strong class="text-light">Data Integrity:</strong>
                  Ensure selected booking add-ons are saved to the database (currently calculated but not persisted).
                </li>
              </ul>
            </div>
          </div>
        </div>
      </section>

      <!-- Recent Fixes & Enhancements (November 2025) -->
      <section id="recent-fixes" class="mb-5">
        <h2 class="section-title text-gold serif">Recent Fixes & Enhancements</h2>
        <p class="text-muted mb-4">
          Latest improvements, bug fixes, and feature enhancements implemented in November 2025.
        </p>

        <!-- Meeting Link Protocol Fix -->
        <div class="card p-4 mb-4 border-success">
          <h5 class="text-success">
            <i class="bi bi-check-circle me-2"></i>Meeting Link Protocol Enforcement
          </h5>
          <p class="text-muted small mt-3 mb-2">
            <strong>Issue:</strong> Meeting links sent in email notifications were not clickable when admins entered URLs without the protocol (e.g., <code>zoom.us/meeting-id</code> instead of <code>https://zoom.us/meeting-id</code>). Email clients interpreted these as relative URLs, making them inaccessible.
          </p>
          <p class="text-muted small mb-2">
            <strong>Solution:</strong> Updated <code>src/admin/api/manage_booking.php</code> to automatically prepend <code>https://</code> to meeting links if they don't start with <code>http://</code> or <code>https://</code>.
          </p>
          <div class="bg-dark border-secondary rounded p-3 mt-2">
            <code class="text-light">
              // Auto-fix meeting link protocol<br>
              if (!preg_match('/^https?:\/\//i', $meetingLink)) {<br>
              &nbsp;&nbsp;$meetingLink = 'https://' . $meetingLink;<br>
              }
            </code>
          </div>
          <p class="text-muted small mt-3 mb-0">
            <strong>Impact:</strong> All meeting links stored in the database and sent via email now use absolute URLs, ensuring universal accessibility across all email clients.
          </p>
        </div>

        <!-- Dashboard Time Filtering -->
        <div class="card p-4 mb-4 border-info">
          <h5 class="text-info">
            <i class="bi bi-calendar-range me-2"></i>Dashboard Time Filtering System
          </h5>
          <p class="text-muted small mt-3 mb-2">
            <strong>Feature:</strong> Implemented comprehensive time-based filtering for all charts and KPIs in the admin dashboard, allowing admins to view metrics for specific timeframes.
          </p>
          
          <p class="text-muted small mb-2"><strong>Files Modified:</strong></p>
          <ul class="text-muted small mb-3">
            <li><code>src/admin/api/get_analytics.php</code> - Added quarter timeframe option and applied date filters to all queries</li>
            <li><code>src/admin/adminDashboard.php</code> - Added "This Quarter" option to the timeframe filter dropdown</li>
          </ul>

          <p class="text-muted small mb-2"><strong>Timeframe Options:</strong></p>
          <ul class="text-muted small mb-3">
            <li><strong>Today</strong> - Shows data for current day</li>
            <li><strong>This Week</strong> - Shows data for current week (Sunday-Saturday)</li>
            <li><strong>This Month</strong> - Shows data for current month</li>
            <li><strong>This Quarter</strong> - Shows data for current quarter (Q1-Q4)</li>
            <li><strong>This Year</strong> - Shows data for current year</li>
            <li><strong>All Time</strong> - Shows complete historical data</li>
          </ul>

          <p class="text-muted small mb-2"><strong>Filtered Metrics:</strong></p>
          <div class="row g-2 mb-3">
            <div class="col-md-6">
              <ul class="text-muted small mb-0">
                <li>Total Revenue</li>
                <li>Total Bookings</li>
                <li>Average Booking Value</li>
                <li>New Clients (dynamic calculation)</li>
              </ul>
            </div>
            <div class="col-md-6">
              <ul class="text-muted small mb-0">
                <li>Revenue Trend Chart</li>
                <li>Top Packages Chart</li>
                <li>Booking Status Distribution</li>
                <li>Event Type Distribution</li>
              </ul>
            </div>
          </div>

          <p class="text-muted small mb-0">
            <strong>Note:</strong> Pending Requests and Upcoming Events remain unfiltered by design, as they show current actionable items regardless of timeframe.
          </p>
        </div>

        <!-- Notification Badge Improvements -->
        <div class="card p-4 mb-4 border-warning">
          <h5 class="text-warning">
            <i class="bi bi-bell me-2"></i>Notification Badge UI Improvements
          </h5>
          <p class="text-muted small mt-3 mb-2">
            <strong>Enhancement:</strong> Improved the notification badge positioning and sizing for better visibility and aesthetics.
          </p>
          <p class="text-muted small mb-2">
            <strong>Changes Made:</strong>
          </p>
          <ul class="text-muted small mb-3">
            <li>Reduced badge font size to <code>0.65rem</code> for a more compact appearance</li>
            <li>Added custom padding (<code>0.25rem 0.4rem</code>) for better spacing</li>
            <li>Maintained proper positioning at top-right of bell icon using Bootstrap utilities</li>
          </ul>
          <p class="text-muted small mb-0">
            <strong>File:</strong> <code>src/admin/components/header.php</code>
          </p>
        </div>

        <!-- Meeting Link Visibility Documentation -->
        <div class="card p-4 border-secondary">
          <h5 class="text-light">
            <i class="bi bi-info-circle me-2"></i>Meeting Link Feature Documentation
          </h5>
          <p class="text-muted small mt-3 mb-2">
            <strong>Clarification:</strong> Meeting link visibility in the user's booking modal is fully functional and correctly implemented.
          </p>
          
          <p class="text-muted small mb-2"><strong>How It Works:</strong></p>
          <ol class="text-muted small mb-3">
            <li>Admin adds a meeting link via the Bookings page booking details modal</li>
            <li>System saves the link to the <code>bookings.meeting_link</code> column</li>
            <li>User receives an email notification with the meeting link</li>
            <li>Link automatically appears in user's appointment modal when viewing booking details</li>
          </ol>

          <p class="text-muted small mb-2"><strong>Implementation Details:</strong></p>
          <ul class="text-muted small mb-0">
            <li><strong>Backend:</strong> <code>src/user/getAppointments.php</code> includes <code>meeting_link</code> in API response</li>
            <li><strong>Frontend:</strong> <code>src/user/appointmentsHandler.js</code> displays link if present (lines 195-205)</li>
            <li><strong>Notifications:</strong> <code>src/admin/api/manage_booking.php</code> sends email when link is added/updated</li>
          </ul>
        </div>
      </section>

      <!-- Future Features -->
      <section id="future" class="mb-5">
        <h2 class="section-title text-gold serif">Future Features Roadmap</h2>
        <p class="text-muted mb-4">
          Proposed enhancements to elevate the Aperture Studios experience.
        </p>

        <div class="row g-4">
          <div class="col-md-4">
            <div class="neo-card h-100">
              <div class="icon-box mb-3"><i class="bi bi-robot"></i></div>
              <h5 class="text-light">AI Integration</h5>
              <p class="text-muted small">
                Smart photo tagging and facial recognition to allow clients to instantly find their photos in large event galleries.
              </p>
            </div>
          </div>
          <div class="col-md-4">
            <div class="neo-card h-100">
              <div class="icon-box mb-3"><i class="bi bi-phone"></i></div>
              <h5 class="text-light">Mobile App</h5>
              <p class="text-muted small">
                Dedicated iOS/Android app for clients to manage bookings, view galleries offline, and receive push notifications.
              </p>
            </div>
          </div>
          <div class="col-md-4">
            <div class="neo-card h-100">
              <div class="icon-box mb-3"><i class="bi bi-credit-card"></i></div>
              <h5 class="text-light">Automated Payments</h5>
              <p class="text-muted small">
                Full integration with Stripe or PayMongo to handle credit card holds, automated downpayments, and instant refunds.
              </p>
            </div>
          </div>
          <div class="col-md-4">
            <div class="neo-card h-100">
              <div class="icon-box mb-3"><i class="bi bi-envelope-heart"></i></div>
              <h5 class="text-light">Marketing Automation</h5>
              <p class="text-muted small">
                Automated email sequences for client retention (e.g., "Anniversary Shoot" reminders 1 year after a wedding).
              </p>
            </div>
          </div>
          <div class="col-md-4">
            <div class="neo-card h-100">
              <div class="icon-box mb-3"><i class="bi bi-star"></i></div>
              <h5 class="text-light">Loyalty Program</h5>
              <p class="text-muted small">
                Points system for frequent bookers (e.g., corporate clients) redeemable for discounts or free prints.
              </p>
            </div>
          </div>
        </div>
      </section>


    
        <div class="card p-4 mb-4 border-warning">
          <h5 class="text-warning">
            <i class="bi bi-bell me-2"></i>Notification Badge UI Improvements
          </h5>
          <p class="text-muted small mt-3 mb-2">
            <strong>Enhancement:</strong> Improved the notification badge positioning and sizing for better visibility and aesthetics.
          </p>
          <p class="text-muted small mb-2">
            <strong>Changes Made:</strong>
          </p>
          <ul class="text-muted small mb-3">
            <li>Reduced badge font size to <code>0.65rem</code> for a more compact appearance</li>
            <li>Added custom padding (<code>0.25rem 0.4rem</code>) for better spacing</li>
            <li>Maintained proper positioning at top-right of bell icon using Bootstrap utilities</li>
          </ul>
          <p class="text-muted small mb-0">
            <strong>File:</strong> <code>src/admin/components/header.php</code>
          </p>
        </div>

        <div class="card p-4 border-secondary">
          <h5 class="text-light">
            <i class="bi bi-info-circle me-2"></i>Meeting Link Feature Documentation
          </h5>
          <p class="text-muted small mt-3 mb-2">
            <strong>Clarification:</strong> Meeting link visibility in the user's booking modal is fully functional and correctly implemented.
          </p>
          
          <p class="text-muted small mb-2"><strong>How It Works:</strong></p>
          <ol class="text-muted small mb-3">
            <li>Admin adds a meeting link via the Bookings page booking details modal</li>
            <li>System saves the link to the <code>bookings.meeting_link</code> column</li>
            <li>User receives an email notification with the meeting link</li>
            <li>Link automatically appears in user's appointment modal when viewing booking details</li>
          </ol>

          <p class="text-muted small mb-2"><strong>Implementation Details:</strong></p>
          <ul class="text-muted small mb-0">
            <li><strong>Backend:</strong> <code>src/user/getAppointments.php</code> includes <code>meeting_link</code> in API response</li>
            <li><strong>Frontend:</strong> <code>src/user/appointmentsHandler.js</code> displays link if present (lines 195-205)</li>
            <li><strong>Notifications:</strong> <code>src/admin/api/manage_booking.php</code> sends email when link is added/updated</li>
          </ul>
        </div>
      </section>


      <section id="future" class="mb-5">
        <h2 class="section-title text-gold serif">Future Features Roadmap</h2>
        <p class="text-muted mb-4">
          Proposed enhancements to elevate the Aperture Studios experience.
        </p>

        <div class="row g-4">
          <div class="col-md-4">
            <div class="neo-card h-100">
              <div class="icon-box mb-3"><i class="bi bi-robot"></i></div>
              <h5 class="text-light">AI Integration</h5>
              <p class="text-muted small">
                Smart photo tagging and facial recognition to allow clients to instantly find their photos in large event galleries.
              </p>
            </div>
          </div>
          <div class="col-md-4">
            <div class="neo-card h-100">
              <div class="icon-box mb-3"><i class="bi bi-phone"></i></div>
              <h5 class="text-light">Mobile App</h5>
              <p class="text-muted small">
                Dedicated iOS/Android app for clients to manage bookings, view galleries offline, and receive push notifications.
              </p>
            </div>
          </div>
          <div class="col-md-4">
            <div class="neo-card h-100">
              <div class="icon-box mb-3"><i class="bi bi-credit-card"></i></div>
              <h5 class="text-light">Automated Payments</h5>
              <p class="text-muted small">
                Full integration with Stripe or PayMongo to handle credit card holds, automated downpayments, and instant refunds.
              </p>
            </div>
          </div>
          <div class="col-md-4">
            <div class="neo-card h-100">
              <div class="icon-box mb-3"><i class="bi bi-envelope-heart"></i></div>
              <h5 class="text-light">Marketing Automation</h5>
              <p class="text-muted small">
                Automated email sequences for client retention (e.g., "Anniversary Shoot" reminders 1 year after a wedding).
              </p>
            </div>
          </div>
          <div class="col-md-4">
            <div class="neo-card h-100">
              <div class="icon-box mb-3"><i class="bi bi-star"></i></div>
              <h5 class="text-light">Loyalty Program</h5>
              <p class="text-muted small">
                Points system for frequent bookers (e.g., corporate clients) redeemable for discounts or free prints.
              </p>
            </div>
          </div>
        </div>
      </section>

      <!-- Comprehensive Testing & Debugging Guide -->
      <section id="testing-guide" class="mb-5">
        <h2 class="section-title text-gold serif">Testing &amp; Debugging Master Guide</h2>
        <p class="text-muted mb-4">
          A complete, industry-standard protocol for verifying system integrity, security, and functionality. 
          Use this guide to ensure zero-bug deployment.
        </p>

        <!-- 1. Pre-Flight Checklist -->
        <div class="card p-4 mb-4">
          <h4 class="text-light mb-3"><i class="bi bi-clipboard-check text-gold me-2"></i>1. Pre-Flight Checklist</h4>
          <p class="text-muted small">Verify the environment before running functional tests.</p>
          <div class="table-responsive">
            <table class="table table-dark table-hover border-secondary table-sm">
              <thead>
                <tr>
                  <th class="text-gold">Component</th>
                  <th class="text-gold">Check</th>
                  <th class="text-gold">Expected Result</th>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td>Environment</td>
                  <td>PHP Version</td>
                  <td>PHP 8.0 or higher running.</td>
                </tr>
                <tr>
                  <td>Database</td>
                  <td>Connection</td>
                  <td><code>config.php</code> connects without error. Tables exist.</td>
                </tr>
                <tr>
                  <td>File System</td>
                  <td>Permissions</td>
                  <td><code>/uploads</code> and <code>/assets</code> are writable (755/777).</td>
                </tr>
                <tr>
                  <td>Dependencies</td>
                  <td>Composer/Vendor</td>
                  <td><code>PHPMailer</code> and other libs are installed.</td>
                </tr>
                <tr>
                  <td>Security</td>
                  <td>SSL/TLS</td>
                  <td>Application runs over HTTPS (or localhost for dev).</td>
                </tr>
              </tbody>
            </table>
          </div>
        </div>

        <!-- 2. Functional Testing Checklist -->
        <div class="card p-4 mb-4">
          <h4 class="text-light mb-3"><i class="bi bi-laptop text-gold me-2"></i>2. Functional Testing Checklist</h4>
          
          <!-- Authentication -->
          <h5 class="text-gold mt-3 border-bottom border-secondary pb-2">A. Authentication Module</h5>
          <div class="form-check mb-2">
            <input class="form-check-input" type="checkbox" id="auth1">
            <label class="form-check-label text-muted" for="auth1"><strong>Registration:</strong> Verify valid email format, password strength (>8 chars), and matching confirm password. Ensure duplicate emails are rejected.</label>
          </div>
          <div class="form-check mb-2">
            <input class="form-check-input" type="checkbox" id="auth2">
            <label class="form-check-label text-muted" for="auth2"><strong>Email Verification:</strong> Check if OTP email is received. Verify correct code works, incorrect code fails.</label>
          </div>
          <div class="form-check mb-2">
            <input class="form-check-input" type="checkbox" id="auth3">
            <label class="form-check-label text-muted" for="auth3"><strong>Login:</strong> Test valid credentials (redirect to dashboard), invalid credentials (error message), and SQL injection attempts in fields.</label>
          </div>
          <div class="form-check mb-2">
            <input class="form-check-input" type="checkbox" id="auth4">
            <label class="form-check-label text-muted" for="auth4"><strong>Forgot Password:</strong> Request reset link. Verify link expires after set time. Ensure new password cannot be same as old.</label>
          </div>
          <div class="form-check mb-2">
            <input class="form-check-input" type="checkbox" id="auth5">
            <label class="form-check-label text-muted" for="auth5"><strong>Session Security:</strong> Verify session timeout after inactivity. Ensure back button doesn't work after logout.</label>
          </div>

          <!-- User Portal -->
          <h5 class="text-gold mt-4 border-bottom border-secondary pb-2">B. User Portal (Client)</h5>
          <div class="form-check mb-2">
            <input class="form-check-input" type="checkbox" id="user1">
            <label class="form-check-label text-muted" for="user1"><strong>Dashboard:</strong> Verify "Total Bookings" and "Total Spent" match database records. Charts should render correctly.</label>
          </div>
          <div class="form-check mb-2">
            <input class="form-check-input" type="checkbox" id="user2">
            <label class="form-check-label text-muted" for="user2"><strong>Booking Flow:</strong> Select package -> Select Date. <strong>CRITICAL:</strong> Ensure dates with confirmed bookings are disabled in calendar.</label>
          </div>
          <div class="form-check mb-2">
            <input class="form-check-input" type="checkbox" id="user3">
            <label class="form-check-label text-muted" for="user3"><strong>Payment Upload:</strong> Upload receipt image. Verify file type validation (JPG/PNG only) and size limit.</label>
          </div>
          <div class="form-check mb-2">
            <input class="form-check-input" type="checkbox" id="user4">
            <label class="form-check-label text-muted" for="user4"><strong>Appointments:</strong> Filter by "Pending", "Confirmed", "Completed". Verify "View Details" modal shows correct info.</label>
          </div>
          <div class="form-check mb-2">
            <input class="form-check-input" type="checkbox" id="user5">
            <label class="form-check-label text-muted" for="user5"><strong>Gallery:</strong> Ensure user can ONLY see photos linked to their booking ID. Test lightbox navigation.</label>
          </div>

          <!-- Admin Portal -->
          <h5 class="text-gold mt-4 border-bottom border-secondary pb-2">C. Admin Portal</h5>
          <div class="form-check mb-2">
            <input class="form-check-input" type="checkbox" id="admin1">
            <label class="form-check-label text-muted" for="admin1"><strong>Analytics:</strong> Verify "Revenue" calculation (Sum of payments - Refunds). Test date filters (Today, Month, Year).</label>
          </div>
          <div class="form-check mb-2">
            <input class="form-check-input" type="checkbox" id="admin2">
            <label class="form-check-label text-muted" for="admin2"><strong>Booking Actions:</strong> Approve booking (Status -> Confirmed). Reject booking (Status -> Rejected). Add Meeting Link (Verify email sent).</label>
          </div>
          <div class="form-check mb-2">
            <input class="form-check-input" type="checkbox" id="admin3">
            <label class="form-check-label text-muted" for="admin3"><strong>Calendar:</strong> Verify all confirmed bookings appear on the correct date/time slots.</label>
          </div>
          <div class="form-check mb-2">
            <input class="form-check-input" type="checkbox" id="admin4">
            <label class="form-check-label text-muted" for="admin4"><strong>Refunds:</strong> Process a refund. Verify status updates in User Portal and "Total Revenue" decreases.</label>
          </div>
          <div class="form-check mb-2">
            <input class="form-check-input" type="checkbox" id="admin5">
            <label class="form-check-label text-muted" for="admin5"><strong>CMS:</strong> Edit Package Price. Verify new price appears on User Booking page immediately.</label>
          </div>
        </div>

        <!-- 3. System-Wide & Security -->
        <div class="card p-4 mb-4">
          <h4 class="text-light mb-3"><i class="bi bi-shield-lock text-gold me-2"></i>3. System-Wide &amp; Security</h4>
          <div class="row g-3">
            <div class="col-md-6">
              <div class="p-3 border border-secondary rounded bg-dark">
                <h6 class="text-gold">Security Audits</h6>
                <ul class="list-unstyled text-muted small mb-0">
                  <li><i class="bi bi-check-circle me-2"></i><strong>SQL Injection:</strong> Test inputs with <code>' OR 1=1 --</code>.</li>
                  <li><i class="bi bi-check-circle me-2"></i><strong>XSS:</strong> Input <code>&lt;script&gt;alert(1)&lt;/script&gt;</code> in contact forms.</li>
                  <li><i class="bi bi-check-circle me-2"></i><strong>CSRF:</strong> Verify <code>csrf_token</code> hidden field exists in ALL forms.</li>
                  <li><i class="bi bi-check-circle me-2"></i><strong>Access Control:</strong> Try accessing <code>/admin</code> pages as a User.</li>
                </ul>
              </div>
            </div>
            <div class="col-md-6">
              <div class="p-3 border border-secondary rounded bg-dark">
                <h6 class="text-gold">Performance &amp; UX</h6>
                <ul class="list-unstyled text-muted small mb-0">
                  <li><i class="bi bi-check-circle me-2"></i><strong>Load Time:</strong> Dashboard loads &lt; 2 seconds.</li>
                  <li><i class="bi bi-check-circle me-2"></i><strong>Mobile:</strong> Sidebar collapses, tables scroll horizontally.</li>
                  <li><i class="bi bi-check-circle me-2"></i><strong>Images:</strong> Thumbnails use <code>object-fit: cover</code>.</li>
                  <li><i class="bi bi-check-circle me-2"></i><strong>404 Page:</strong> Visit non-existent URL.</li>
                </ul>
              </div>
            </div>
          </div>
        </div>

        <!-- 4. Debugging Protocol -->
        <div class="card p-4 mb-4">
          <h4 class="text-light mb-3"><i class="bi bi-bug text-gold me-2"></i>4. Debugging Protocol</h4>
          <p class="text-muted small">Follow this flow when a bug is reported.</p>
          <div class="alert alert-secondary bg-dark border-secondary text-light">
            <strong>Step 1: Reproduce.</strong> Can you make it happen again? <br>
            <strong>Step 2: Check Logs.</strong> Look at <code>/var/log/apache2/error.log</code> or PHP error output.<br>
            <strong>Step 3: Check Network.</strong> Open DevTools (F12) -> Network. Look for red (4xx/5xx) requests.<br>
            <strong>Step 4: Check Database.</strong> Is the data actually saved? Use phpMyAdmin.<br>
            <strong>Step 5: Isolate.</strong> Comment out recent code changes to find the culprit.
          </div>
        </div>

        <!-- 5. Role-Based Hard Questions -->
        <div class="card p-4">
          <h4 class="text-light mb-3"><i class="bi bi-patch-question text-gold me-2"></i>5. Role-Based Knowledge Check (Hard Mode)</h4>
          <p class="text-muted small mb-4">Deep-dive questions to test mastery of the system logic.</p>
          
          <div class="accordion" id="hardQuestions">
            
            <!-- Admin Questions -->
            <div class="accordion-item bg-dark border-secondary">
              <h2 class="accordion-header" id="hqAdmin">
                <button class="accordion-button collapsed bg-dark text-gold" type="button" data-bs-toggle="collapse" data-bs-target="#collapseAdmin">
                  <i class="bi bi-person-badge-fill me-2"></i> Admin Role
                </button>
              </h2>
              <div id="collapseAdmin" class="accordion-collapse collapse" data-bs-parent="#hardQuestions">
                <div class="accordion-body text-muted">
                  <ol>
                    <li class="mb-3">
                      <strong>Q: How do you resolve a booking conflict where two users pay simultaneously for the same slot?</strong><br>
                      <span class="text-light">A: The system uses a "First-to-Confirm" logic. The database transaction for the second approval will fail or be blocked if the slot is already marked 'Confirmed'. You must manually refund the second user and offer an alternative slot.</span>
                    </li>
                    <li class="mb-3">
                      <strong>Q: What is the exact SQL logic for calculating 'Net Revenue' vs 'Gross Revenue'?</strong><br>
                      <span class="text-light">A: Gross = Sum of <code>total_amount</code> for all 'Confirmed' bookings. Net = (Sum of <code>downpayment_amount</code> + Sum of <code>final_payment_amount</code>) - Sum of <code>refund_amount</code>. We track actual cash flow, not just booking value.</span>
                    </li>
                    <li class="mb-3">
                      <strong>Q: How does the system handle a 'pending' booking that expires (past event date)?</strong><br>
                      <span class="text-light">A: It remains in the database as 'Pending' but is filtered out of the 'Upcoming' view. A cron job (or manual admin action) should mark these as 'Cancelled' or 'Archived' to clean up the dashboard.</span>
                    </li>
                    <li class="mb-3">
                      <strong>Q: Explain the security implications of the `photoUpload.php` file handling.</strong><br>
                      <span class="text-light">A: We do not store files directly in the web root without validation. We check MIME types (image/jpeg, image/png) and rename files with a unique hash to prevent overwriting and execution of malicious scripts (e.g., shell.php.jpg).</span>
                    </li>
                    <li>
                      <strong>Q: If the email server fails (SMTP Error), how do you manually verify a user?</strong><br>
                      <span class="text-light">A: Go to the database <code>users</code> table, find the user by email, and manually set the <code>isVerified</code> column to <code>1</code>. Then notify the user via alternative means.</span>
                    </li>
                  </ol>
                </div>
              </div>
            </div>

            <!-- User Questions -->
            <div class="accordion-item bg-dark border-secondary">
              <h2 class="accordion-header" id="hqUser">
                <button class="accordion-button collapsed bg-dark text-gold" type="button" data-bs-toggle="collapse" data-bs-target="#collapseUser">
                  <i class="bi bi-person-circle me-2"></i> User (Client) Role
                </button>
              </h2>
              <div id="collapseUser" class="accordion-collapse collapse" data-bs-parent="#hardQuestions">
                <div class="accordion-body text-muted">
                  <ol>
                    <li class="mb-3">
                      <strong>Q: What happens to my downpayment if I cancel 24 hours before the event?</strong><br>
                      <span class="text-light">A: Per the Terms of Service, downpayments are non-refundable within 48 hours of the event. The system will mark the booking as 'Cancelled' but the refund amount will be calculated as 0 unless overridden by an Admin.</span>
                    </li>
                    <li class="mb-3">
                      <strong>Q: Can I download my photos in full resolution without a watermark?</strong><br>
                      <span class="text-light">A: Yes, but only after the Final Payment is marked as 'Paid' by the admin. The 'Download' button in the Gallery is disabled/hidden until the booking status is 'Completed' or payment is verified.</span>
                    </li>
                    <li class="mb-3">
                      <strong>Q: How do I change my registered email address without losing my booking history?</strong><br>
                      <span class="text-light">A: You cannot change it yourself for security reasons. You must contact Admin via the 'Inquiries' page. The Admin will update the <code>users</code> table, which preserves the <code>userID</code> linkage to your bookings.</span>
                    </li>
                    <li class="mb-3">
                      <strong>Q: If I forget my password and the reset link doesn't arrive, what should I do?</strong><br>
                      <span class="text-light">A: Check Spam folder first. If still missing, it means the SMTP service is down or your email provider blocked it. Contact Support to manually trigger a password reset or verify your identity.</span>
                    </li>
                    <li>
                      <strong>Q: Is my payment information (Credit Card) stored on your servers?</strong><br>
                      <span class="text-light">A: No. We only record the <em>transaction reference number</em> and the <em>status</em>. Actual processing is done via the external gateway or manual bank transfer, so your sensitive financial data never touches our DB.</span>
                    </li>
                  </ol>
                </div>
              </div>
            </div>

          </div>
        </div>
      </section>

      <!-- System Analysis & Interview Guide -->
      <section id="interview-guide" class="mb-5">
        <h2 class="section-title text-gold serif">System Analysis & Interview Guide</h2>
        <p class="text-muted mb-4">
          Advanced role-based scenarios and analysis for system improvement and candidate evaluation.
        </p>

        <div class="card p-4">
          <div class="accordion" id="interviewQuestions">
            
            <!-- 1. UI/UX Designer -->
            <div class="accordion-item bg-dark border-secondary">
              <h2 class="accordion-header" id="headingUIUX">
                <button class="accordion-button collapsed bg-dark text-gold" type="button" data-bs-toggle="collapse" data-bs-target="#collapseUIUX">
                  <i class="bi bi-palette me-2"></i> 1. UI/UX Designer
                </button>
              </h2>
              <div id="collapseUIUX" class="accordion-collapse collapse" data-bs-parent="#interviewQuestions">
                <div class="accordion-body text-muted">
                  <p><strong>Focus:</strong> Accessibility vs. Aesthetics, Information Architecture in High-Contrast Themes.</p>
                  <p class="text-light"><strong>Question:</strong> "The Aperture system enforces a strict 'Luxury Dark Theme' using gold accents (#D4AF37) on dark backgrounds (#101010) with glassmorphism effects. While visually striking, this poses usability challenges in the Admin Dashboard (<code>adminDashboard.php</code>), specifically with the 'Revenue Trend' charts and dense data tables. How would you redesign the data visualization components to adhere to WCAG 2.1 AA accessibility standards for low-vision users without compromising the 'premium' brand identity?"</p>
                  <hr class="border-secondary">
                  <h6 class="text-gold">Best Answer</h6>
                  <p><strong>Analysis:</strong> Acknowledges that gold-on-black often fails contrast ratios for small text.</p>
                  <p><strong>Solution:</strong></p>
                  <ul>
                    <li><strong>Semantic Color Mapping:</strong> Propose using the Gold color (#D4AF37) only for primary actions and key data points, while shifting secondary text (axes, labels) to a high-contrast off-white (#E9ECEF) instead of the current muted gray.</li>
                    <li><strong>Chart Optimization:</strong> For the ApexCharts implementation (<code>dashboard-charts.js</code>), suggest adding distinct patterns or textures to bar/pie charts in addition to color, ensuring users with color blindness can distinguish segments.</li>
                    <li><strong>Glassmorphism Refinement:</strong> Propose increasing the opacity of the neo-card background (currently rgba(255, 255, 255, 0.02)) to at least 90% opacity for containers holding text, ensuring the background image doesn't interfere with legibility, while keeping the 'glass' border and glow effects.</li>
                  </ul>
                </div>
              </div>
            </div>

            <!-- 2. Full Stack Developer -->
            <div class="accordion-item bg-dark border-secondary">
              <h2 class="accordion-header" id="headingFullStack">
                <button class="accordion-button collapsed bg-dark text-gold" type="button" data-bs-toggle="collapse" data-bs-target="#collapseFullStack">
                  <i class="bi bi-code-slash me-2"></i> 2. Full Stack Developer
                </button>
              </h2>
              <div id="collapseFullStack" class="accordion-collapse collapse" data-bs-parent="#interviewQuestions">
                <div class="accordion-body text-muted">
                  <p><strong>Focus:</strong> Session Management, Security, and Frontend-Backend Synchronization.</p>
                  <p class="text-light"><strong>Question:</strong> "We recently implemented a client-side CSRF token auto-refresh mechanism in <code>src/user/js/csrf_handler.js</code> to prevent form expiration during long booking sessions. Analyze the potential race condition or security flaw this introduces if a user has the application open in multiple tabs. How would you refactor the <code>auth.php</code> session logic and the frontend handler to support multi-tab usage without invalidating active forms?"</p>
                  <hr class="border-secondary">
                  <h6 class="text-gold">Best Answer</h6>
                  <p><strong>Analysis:</strong> Identifies that if Tab A refreshes the CSRF token, the token in Tab B becomes invalid if the server rotates tokens on every request (or if the session ID is regenerated). Submitting a form in Tab B would then fail.</p>
                  <p><strong>Solution:</strong></p>
                  <ul>
                    <li><strong>Backend (csrf.php):</strong> Implement a "per-session" token strategy (valid for the session life) rather than "per-request", OR maintain a list of recently valid tokens (token rotation with grace period).</li>
                    <li><strong>Frontend (csrf_handler.js):</strong> Use the Broadcast Channel API or localStorage event listeners. When Tab A refreshes the token and updates localStorage, Tab B detects the change and updates its hidden csrfToken input field immediately, keeping all tabs synchronized with the active session state.</li>
                  </ul>
                </div>
              </div>
            </div>

            <!-- 3. Quality Control (QC) -->
            <div class="accordion-item bg-dark border-secondary">
              <h2 class="accordion-header" id="headingQC">
                <button class="accordion-button collapsed bg-dark text-gold" type="button" data-bs-toggle="collapse" data-bs-target="#collapseQC">
                  <i class="bi bi-shield-check me-2"></i> 3. Quality Control (QC) / QA Engineer
                </button>
              </h2>
              <div id="collapseQC" class="accordion-collapse collapse" data-bs-parent="#interviewQuestions">
                <div class="accordion-body text-muted">
                  <p><strong>Focus:</strong> Edge Cases, Security Testing, and Destructive Testing.</p>
                  <p class="text-light"><strong>Question:</strong> "The <code>photoUpload.php</code> module allows admins to upload client photos. The frontend (<code>booking-modal.js</code>) restricts files to images under 5MB. Design a 'Destructive Testing' strategy to bypass these frontend checks and verify the server-side robustness of <code>manage_booking.php</code>. What specific payloads and tools would you use to test for Remote Code Execution (RCE) and MIME-type spoofing vulnerabilities?"</p>
                  <hr class="border-secondary">
                  <h6 class="text-gold">Best Answer</h6>
                  <p><strong>Analysis:</strong> Frontend validation is for UX, not security.</p>
                  <p><strong>Strategy:</strong></p>
                  <ul>
                    <li><strong>Tooling:</strong> Use Burp Suite or Postman to intercept the HTTP request after the JS validation passes.</li>
                    <li><strong>Payloads:</strong>
                      <ul>
                        <li><strong>Extension Spoofing:</strong> Rename shell.php to shell.jpg.php or shell.php%00.jpg (Null Byte injection) to test if the server relies only on file extensions.</li>
                        <li><strong>MIME Spoofing:</strong> Upload a PHP script but change the Content-Type header to image/jpeg.</li>
                        <li><strong>Polyglot Files:</strong> Upload a valid JPEG image that contains embedded PHP code in the EXIF data.</li>
                      </ul>
                    </li>
                    <li><strong>Verification:</strong> The answer must confirm that the backend uses getimagesize() or finfo_file() to verify the actual file content, and renames files upon storage (e.g., using a UUID) to prevent execution of malicious scripts.</li>
                  </ul>
                </div>
              </div>
            </div>

            <!-- 4. System Analyst -->
            <div class="accordion-item bg-dark border-secondary">
              <h2 class="accordion-header" id="headingAnalyst">
                <button class="accordion-button collapsed bg-dark text-gold" type="button" data-bs-toggle="collapse" data-bs-target="#collapseAnalyst">
                  <i class="bi bi-diagram-3 me-2"></i> 4. System Analyst
                </button>
              </h2>
              <div id="collapseAnalyst" class="accordion-collapse collapse" data-bs-parent="#interviewQuestions">
                <div class="accordion-body text-muted">
                  <p><strong>Focus:</strong> Data Modeling, Scalability, and Business Logic Decoupling.</p>
                  <p class="text-light"><strong>Question:</strong> "Currently, the system couples 'Operational Status' (Pending/Confirmed) directly with 'Financial Status' (Downpayment Paid). A booking cannot be 'Confirmed' until a downpayment is verified. Critique this data model in the context of onboarding 'Corporate Clients' who pay Net-30 days after the event. How would you restructure the Entity-Relationship Diagram (ERD) and <code>booking_logic.php</code> to decouple these states?"</p>
                  <hr class="border-secondary">
                  <h6 class="text-gold">Best Answer</h6>
                  <p><strong>Analysis:</strong> The current logic is too rigid for B2B workflows.</p>
                  <p><strong>Solution:</strong></p>
                  <ul>
                    <li><strong>Schema Change:</strong> Split booking_status into two distinct columns: operational_status (Pending, Scheduled, Completed) and payment_status (Unpaid, Partial, Paid, Overdue).</li>
                    <li><strong>Entity Update:</strong> Add a client_type (Individual/Corporate) field to the users table.</li>
                    <li><strong>Logic Update:</strong> Modify <code>manage_booking.php</code>.
                      <ul>
                        <li>If Client = Individual: operational_status = 'Scheduled' ONLY IF payment_status != 'Unpaid'.</li>
                        <li>If Client = Corporate: Allow operational_status = 'Scheduled' even if payment_status = 'Unpaid'.</li>
                      </ul>
                    </li>
                    <li><strong>Impact:</strong> Update <code>get_dashboard_metrics.php</code> to calculate 'Revenue' based on payment_status (actual cash) vs 'Projected Revenue' based on operational_status.</li>
                  </ul>
                </div>
              </div>
            </div>

            <!-- 5. Business Process Manager (BPM) -->
            <div class="accordion-item bg-dark border-secondary">
              <h2 class="accordion-header" id="headingBPM">
                <button class="accordion-button collapsed bg-dark text-gold" type="button" data-bs-toggle="collapse" data-bs-target="#collapseBPM">
                  <i class="bi bi-kanban me-2"></i> 5. Business Process Manager (BPM)
                </button>
              </h2>
              <div id="collapseBPM" class="accordion-collapse collapse" data-bs-parent="#interviewQuestions">
                <div class="accordion-body text-muted">
                  <p><strong>Focus:</strong> Process Efficiency, Automation, and Bottleneck Analysis.</p>
                  <p class="text-light"><strong>Question:</strong> "The current 'Refund Process' (<code>refunds.php</code>) is a high-friction loop: Client requests -> Admin calculates eligibility manually -> Admin approves -> Admin manually processes payment. Map out a 'To-Be' process flow that reduces Admin Turnaround Time (TAT) by 50%. Which specific decision points can be automated using the existing database data (event_date, created_at)?"</p>
                  <hr class="border-secondary">
                  <h6 class="text-gold">Best Answer</h6>
                  <p><strong>Analysis:</strong> The bottleneck is the manual calculation of refund amounts based on policy (e.g., '40% if cancelled > 7 days').</p>
                  <p><strong>Solution:</strong></p>
                  <ul>
                    <li><strong>Automated Decision Support:</strong> When a user requests cancellation, the system (<code>cancelBooking.php</code>) should immediately calculate the refund amount based on the DATEDIFF(event_date, NOW()) logic and the stored policy.</li>
                    <li><strong>Pre-Approval:</strong> The Admin Dashboard should display the request with a pre-calculated tag: "System Recommendation: Approve (₱5,000 Refund)" or "System Recommendation: Reject (Within 24h window)".</li>
                    <li><strong>One-Click Action:</strong> The Admin only needs to click "Confirm Recommendation".</li>
                    <li><strong>Notification:</strong> The system automatically triggers the email (email_helper.php) with the breakdown, removing the need for the admin to draft a response.</li>
                  </ul>
                </div>
              </div>
            </div>

          </div>
        </div>
      </section>

      <!-- Authentication System Documentation -->
      <section id="authentication" class="mb-5">
        <h2 class="section-title text-gold serif">Authentication System</h2>
        <p class="text-muted mb-4">
          Comprehensive documentation covering login, registration, forgot password, and email verification processes.
        </p>

        <!-- Overview Cards -->
        <div class="row g-4 mb-5">
          <div class="col-md-6">
            <div class="card p-4 h-100">
              <h5 class="text-gold mb-3">
                <i class="bi bi-shield-check"></i> Security Features
              </h5>
              <ul class="text-light small mb-0">
                <li><strong>CSRF Protection:</strong> All forms protected with tokens</li>
                <li><strong>Rate Limiting:</strong> 5 failed attempts = 60s lockout</li>
                <li><strong>Email Verification:</strong> OTP-based email confirmation</li>
                <li><strong>Password Security:</strong> bcrypt hashing (PASSWORD_DEFAULT)</li>
                <li><strong>Anti-Enumeration:</strong> Prevents email discovery</li>
              </ul>
            </div>
          </div>
          <div class="col-md-6">
            <div class="card p-4 h-100">
              <h5 class="text-gold mb-3">
                <i class="bi bi-diagram-3"></i> System Components
              </h5>
              <ul class="text-light small mb-0">
                <li><code>register.php</code> - User registration + OTP verification</li>
                <li><code>logIn.php</code> - Authentication + account recovery</li>
                <li><code>forgot1.php</code> - Password reset (3-step process)</li>
                <li><code>completeProfile.php</code> - Profile completion</li>
                <li><code>auth.php</code> - Core authentication functions</li>
              </ul>
            </div>
          </div>
        </div>

        <!-- Registration Process -->
        <h4 class="text-light mt-5 mb-3">1. Registration System</h4>
        <div class="card p-4 mb-4">
          <h6 class="text-gold">Process Overview</h6>
          <div class="table-responsive">
            <table class="table table-dark table-sm table-hover border-secondary">
              <thead>
                <tr>
                  <th class="text-gold">Step</th>
                  <th class="text-gold">Action</th>
                  <th class="text-gold">Validation</th>
                  <th class="text-gold">Outcome</th>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td>1</td>
                  <td>User submits email + password</td>
                  <td>Email format, unique email, password strength (8+ chars, upper, lower, number, special)</td>
                  <td>User record created with <code>status='pending'</code></td>
                </tr>
                <tr>
                  <td>2</td>
                  <td>System generates 6-digit OTP</td>
                  <td>Random numeric code (str_pad 6 digits)</td>
                  <td>OTP sent via email, stored in DB with 5-min expiry</td>
                </tr>
                <tr>
                  <td>3</td>
                  <td>User enters OTP code</td>
                  <td>Must match DB, not expired, under 5 failed attempts</td>
                  <td>Email verified, <code>status='active'</code>, redirects to profile completion</td>
                </tr>
              </tbody>
            </table>
          </div>

          <h6 class="text-gold mt-4">Edge Cases & Prevention</h6>
          <ul class="text-light small">
            <li><strong>Email Already Exists (Active):</strong> Error "An account with this email already exists." - prevents duplicates</li>
            <li><strong>Email Archived:</strong> SweetAlert prompts user to recover account via login - prevents confusion</li>
            <li><strong>Weak Password:</strong> Inline validation errors with specific requirements - ensures security</li>
            <li><strong>Wrong OTP (< 5 attempts):</strong> Error displayed, retry allowed - user-friendly</li>
            <li><strong>Wrong OTP (5th attempt):</strong> Account locked for 60 seconds with countdown timer - prevents brute force</li>
            <li><strong>Expired OTP (> 5 min):</strong> Error shown, user must resend - maintains security window</li>
            <li><strong>Resend Spamming:</strong> 60-second cooldown between resend requests - prevents abuse</li>
          </ul>
        </div>

        <!-- Login Process -->
        <h4 class="text-light mt-5 mb-3">2. Login System</h4>
        <div class="card p-4 mb-4">
          <h6 class="text-gold">Login Flow Scenarios</h6>
          <div class="table-responsive">
            <table class="table table-dark table-sm table-hover border-secondary">
              <thead>
                <tr>
                  <th class="text-gold">Scenario</th>
                  <th class="text-gold">Condition</th>
                  <th class="text-gold">System Response</th>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td>✅ Success (Verified + Complete)</td>
                  <td>Credentials valid, email verified, profile complete</td>
                  <td>Full session created → Dashboard redirect (Admin/User based on role)</td>
                </tr>
                <tr>
                  <td>⚠️ Unverified Account</td>
                  <td>Credentials valid but <code>isVerified=false</code></td>
                  <td>System generates & sends OTP → Forces email verification → Then profile completion</td>
                </tr>
                <tr>
                  <td>⚠️ Incomplete Profile</td>
                  <td>Verified but profile fields missing</td>
                  <td>Partial session created → Redirects to <code>completeProfile.php</code></td>
                </tr>
                <tr>
                  <td>❌ Wrong Credentials (< 5 attempts)</td>
                  <td>Invalid email or password</td>
                  <td>Generic error "Invalid email or password" - prevents enumeration</td>
                </tr>
                <tr>
                  <td>🔒 Account Locked (5 attempts)</td>
                  <td>5 consecutive failed login attempts</td>
                  <td>60-second lockout with countdown timer, automatic unlock after duration</td>
                </tr>
                <tr>
                  <td>🗂️ Archived Account</td>
                  <td><code>status='archived'</code> with correct password</td>
                  <td>SweetAlert modal offers account recovery → Reactivates to 'active' → Auto-login</td>
                </tr>
              </tbody>
            </table>
          </div>

          <h6 class="text-gold mt-4">Security Measures</h6>
          <ul class="text-light small">
            <li><strong>Timing Attack Prevention:</strong> Dummy password hash verification for non-existent users (same execution time)</li>
            <li><strong>Generic Error Messages:</strong> "Invalid email or password" doesn't reveal which field is wrong</li>
            <li><strong>Database-Tracked Lockout:</strong> Lock timestamp stored in DB, can't bypass via refresh</li>
            <li><strong>Password Verification:</strong> Uses <code>password_verify()</code> with bcrypt hashes</li>
          </ul>
        </div>

        <!-- Forgot Password Process -->
        <h4 class="text-light mt-5 mb-3">3. Forgot Password System</h4>
        <div class="card p-4 mb-4">
          <h6 class="text-gold">3-Step Password Reset Process</h6>
          <div class="table-responsive">
            <table class="table table-dark table-sm table-hover border-secondary">
              <thead>
                <tr>
                  <th class="text-gold">Step</th>
                  <th class="text-gold">User Action</th>
                  <th class="text-gold">System Behavior</th>
                  <th class="text-gold">Page</th>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td>1</td>
                  <td>Enter email address</td>
                  <td><strong>If email exists:</strong> Send OTP<br><strong>If email doesn't exist:</strong> Fake success message (prevents enumeration)</td>
                  <td><code>forgot1.php</code> (Email Form)</td>
                </tr>
                <tr>
                  <td>2</td>
                  <td>Enter 6-digit OTP from email</td>
                  <td>Validate OTP (5-min expiry), rate limiting (5 attempts), set session for password reset</td>
                  <td><code>forgot1.php</code> (OTP Form)</td>
                </tr>
                <tr>
                  <td>3</td>
                  <td>Create new password + confirm</td>
                  <td>Validate password strength, ensure new ≠ old password (hash comparison), update DB</td>
                  <td><code>forgot1.php</code> (Password Form)</td>
                </tr>
              </tbody>
            </table>
          </div>

          <h6 class="text-gold mt-4">Email Enumeration Prevention</h6>
          <p class="text-light small">
            When a user requests password reset for a non-existent email, the system:
          </p>
          <ol class="text-light small">
            <li>Adds random delay (1-2 seconds) via <code>sleep(rand(1, 2))</code> to mimic real processing</li>
            <li>Shows same success message: "Verification Code Sent"</li>
            <li>Displays same OTP input form (but validation will always fail for fake requests)</li>
            <li><strong>Purpose:</strong> Prevents attackers from discovering which emails are registered in the system</li>
          </ol>

          <h6 class="text-gold mt-4">Password Reuse Prevention</h6>
          <p class="text-light small">
            System prevents users from setting their new password to match their current password:
          </p>
          <ul class="text-light small">
            <li>Retrieves current password hash from database</li>
            <li>Uses <code>password_verify()</code> to check if new password matches old hash</li>
            <li>If match found: Error "New password cannot be the same as your current password"</li>
            <li><strong>Security Benefit:</strong> Enforces meaningful password changes during reset</li>
          </ul>
        </div>

        <!-- Profile Completion -->
        <h4 class="text-light mt-5 mb-3">4. Profile Completion System</h4>
        <div class="card p-4 mb-4">
          <h6 class="text-gold">Required Fields & Validation</h6>
          <div class="table-responsive">
            <table class="table table-dark table-sm table-hover border-secondary">
              <thead>
                <tr>
                  <th class="text-gold">Field</th>
                  <th class="text-gold">Validation Rules</th>
                  <th class="text-gold">Example</th>
                  <th class="text-gold">Error Handling</th>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td>First Name</td>
                  <td>Required, non-empty</td>
                  <td><code>Juan</code></td>
                  <td>"First Name is required"</td>
                </tr>
                <tr>
                  <td>Last Name</td>
                  <td>Required, non-empty</td>
                  <td><code>Dela Cruz</code></td>
                  <td>"Last name is required"</td>
                </tr>
                <tr>
                  <td>Contact Number</td>
                  <td>Required, exactly 11 digits, must start with "09", numeric only</td>
                  <td><code>09171234567</code></td>
                  <td>"Contact number must start with 09" / "Invalid contact number"</td>
                </tr>
                <tr>
                  <td>Terms & Conditions</td>
                  <td>Must be checked (browser validation)</td>
                  <td><code>checked</code></td>
                  <td>Browser prevents submission</td>
                </tr>
              </tbody>
            </table>
          </div>

          <h6 class="text-gold mt-4">Philippine Mobile Number Validation</h6>
          <p class="text-light small"><strong>Format:</strong> <code>09XXXXXXXXX</code> (11 digits)</p>
          <ul class="text-light small">
            <li><strong>Regex Pattern:</strong> <code>/^09[0-9]{9}$/</code></li>
            <li><strong>Checks:</strong> Starts with "09", exactly 11 digits, all numeric</li>
            <li><strong>Valid Examples:</strong> 09171234567, 09051234567, 09991234567</li>
            <li><strong>Invalid Examples:</strong> 9171234567 (missing 0), +639171234567 (wrong format), 081234567891 (12 digits)</li>
          </ul>
        </div>

        <!-- Security Summary Table -->
        <h4 class="text-light mt-5 mb-3">5. Security Measures Summary</h4>
        <div class="card p-4">
          <div class="table-responsive">
            <table class="table table-dark table-hover border-secondary">
              <thead>
                <tr>
                  <th class="text-gold">Threat</th>
                  <th class="text-gold">Prevention Mechanism</th>
                  <th class="text-gold">Implementation</th>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td>Brute Force Attacks</td>
                  <td>Rate Limiting</td>
                  <td>5 failed attempts = 60-second lockout (tracked in <code>ratelimiting</code> table)</td>
                </tr>
                <tr>
                  <td>CSRF Attacks</td>
                  <td>CSRF Tokens</td>
                  <td>All forms include <code>csrfField()</code> validated via <code>validateCSRFToken()</code></td>
                </tr>
                <tr>
                  <td>Email Enumeration</td>
                  <td>Fake Success Messages</td>
                  <td>Same response for existing/non-existing emails + random delays (1-2s)</td>
                </tr>
                <tr>
                  <td>Timing Attacks</td>
                  <td>Constant-Time Operations</td>
                  <td>Dummy password verification for non-existent users, random delays</td>
                </tr>
                <tr>
                  <td>Weak Passwords</td>
                  <td>Complex Password Requirements</td>
                  <td>Min 8 chars, upper, lower, number, special character (validated via <code>validatePassword()</code>)</td>
                </tr>
                <tr>
                  <td>Session Hijacking</td>
                  <td>Secure Session Management</td>
                  <td>Server-side validation, verification states, auto-expire mechanisms</td>
                </tr>
                <tr>
                  <td>Expired OTP Usage</td>
                  <td>Time-Based Validation</td>
                  <td>5-minute expiration window (<code>codeExpires_at > NOW()</code>)</td>
                </tr>
                <tr>
                  <td>Password Reuse</td>
                  <td>Hash Comparison</td>
                  <td>Prevents setting new password same as current during reset</td>
                </tr>
                <tr>
                  <td>Bot Attacks</td>
                  <td>CSRF + Rate Limiting</td>
                  <td>Combined protection prevents automated submissions</td>
                </tr>
                <tr>
                  <td>Account Takeover</td>
                  <td>Email Verification Required</td>
                  <td>Users must verify email via OTP before accessing account</td>
                </tr>
              </tbody>
            </table>
          </div>
        </div>
      </section>

      <!-- Team Role Distribution -->
      <section id="team-roles" class="mb-5">
        <h2 class="section-title text-gold serif">Team Role Distribution & Presentation Responsibilities</h2>
        <p class="text-muted mb-4">
          Contribution breakdown for the Aperture Studios project, including individual responsibilities and presentation assignments.
        </p>

        <!-- Team Structure Overview -->
        <div class="row g-4 mb-5">
          <div class="col-md-12">
            <div class="card p-4">
              <h5 class="text-gold mb-3">
                <i class="bi bi-people-fill"></i> Team Composition
              </h5>
              <p class="text-light">
                The Aperture Studios project was developed by a multidisciplinary team of 5 members, each specializing in critical aspects of system development:
              </p>
              <ul class="text-light small">
                <li><strong>UI/UX Designer:</strong> User interface design and user experience optimization</li>
                <li><strong>Full Stack Developer:</strong> Complete system implementation (frontend + backend)</li>
                <li><strong>Business Process Manager (BPM):</strong> Workflow design and process optimization</li>
                <li><strong>System Analyst:</strong> Requirements analysis and system architecture</li>
                <li><strong>Quality Control (QC):</strong> Testing, validation, and quality assurance</li>
              </ul>
            </div>
          </div>
        </div>

        <!-- Detailed Role Breakdown -->
        <div class="row g-4 mb-4">
          <!-- UI/UX Designer -->
          <div class="col-md-6">
            <div class="card p-4 h-100">
              <h6 class="text-gold mb-3">
                <i class="bi bi-palette-fill"></i> UI/UX Designer
              </h6>
              <p class="text-light small"><strong>Primary Contributions:</strong></p>
              <ul class="text-light small">
                <li>Designed all user interfaces using Figma/Adobe XD</li>
                <li>Created responsive layouts for public, user, and admin portals</li>
                <li>Developed design system (<code>luxuryDesignSystem.css</code>)</li>
                <li>Established color schemes, typography, and component library</li>
                <li>Designed user flows and wireframes for all major features</li>
                <li>Optimized mobile responsiveness and accessibility</li>
              </ul>
              <p class="text-light small"><strong>Presentation Responsibilities:</strong></p>
              <ul class="text-warning small">
                <li><strong>Present:</strong> UI/UX Design Showcase</li>
                <li><strong>Explain:</strong> Design decisions, color theory, user journey maps</li>
                <li><strong>Demo:</strong> Interactive prototypes, responsive design across devices</li>
                <li><strong>Highlight:</strong> Before/after iterations, accessibility features</li>
              </ul>
            </div>
          </div>

          <!-- Full Stack Developer -->
          <div class="col-md-6">
            <div class="card p-4 h-100">
              <h6 class="text-gold mb-3">
                <i class="bi bi-code-slash"></i> Full Stack Developer
              </h6>
              <p class="text-light small"><strong>Primary Contributions:</strong></p>
              <ul class="text-light small">
                <li>Implemented entire codebase (PHP backend + JavaScript frontend)</li>
                <li>Built authentication system (registration, login, forgot password)</li>
                <li>Developed booking system, calendar integration, payment flow</li>
                <li>Created admin dashboard with analytics (ApexCharts)</li>
                <li>Implemented API endpoints for AJAX interactions</li>
                <li>Database design and migration scripts (MySQL)</li>
                <li>Email system integration (PHPMailer with SMTP)</li>
                <li>Security implementation (CSRF, rate limiting, password hashing)</li>
              </ul>
              <p class="text-light small"><strong>Presentation Responsibilities:</strong></p>
              <ul class="text-warning small">
                <li><strong>Present:</strong> Authentication System Process Flow</li>
                <li><strong>Explain:</strong> Login/Registration/Forgot Password with all validations and edge cases</li>
                <li><strong>Demo:</strong> Live coding walkthrough of key functions (e.g., <code>registerUser()</code>, <code>verifyEmail()</code>)</li>
                <li><strong>Highlight:</strong> Security measures (OTP verification, rate limiting, CSRF protection)</li>
                <li><strong>Cover:</strong> Database schema, API architecture, email verification flow</li>
              </ul>
            </div>
          </div>

          <!-- Business Process Manager -->
          <div class="col-md-6">
            <div class="card p-4 h-100">
              <h6 class="text-gold mb-3">
                <i class="bi bi-diagram-3-fill"></i> Business Process Manager (BPM)
              </h6>
              <p class="text-light small"><strong>Primary Contributions:</strong></p>
              <ul class="text-light small">
                <li>Mapped existing manual business processes (as-is analysis)</li>
                <li>Designed automated workflows (booking, payment, refund processes)</li>
                <li>Created process flow diagrams (Mermaid, Lucidchart)</li>
                <li>Defined business rules for refunds, cancellations, and payments</li>
                <li>Optimized admin workflows to reduce turnaround time</li>
                <li>Documented user journey from booking to photo delivery</li>
              </ul>
              <p class="text-light small"><strong>Presentation Responsibilities:</strong></p>
              <ul class="text-warning small">
                <li><strong>Present:</strong> Business Process Flows</li>
                <li><strong>Explain:</strong> Booking lifecycle, refund policy automation, payment workflow</li>
                <li><strong>Demo:</strong> Process diagrams (registration → verification → profile → booking)</li>
                <li><strong>Highlight:</strong> Before (manual) vs. After (automated) process improvements</li>
                <li><strong>Metrics:</strong> Time savings, error reduction, user satisfaction improvements</li>
              </ul>
            </div>
          </div>

          <!-- System Analyst -->
          <div class="col-md-6">
            <div class="card p-4 h-100">
              <h6 class="text-gold mb-3">
                <i class="bi bi-clipboard-data-fill"></i> System Analyst
              </h6>
              <p class="text-light small"><strong>Primary Contributions:</strong></p>
              <ul class="text-light small">
                <li>Conducted requirements gathering and stakeholder interviews</li>
                <li>Created System Requirements Specification (SRS) document</li>
                <li>Designed Entity Relationship Diagrams (ERD)</li>
                <li>Defined functional and non-functional requirements</li>
                <li>Architecture planning (LAMP stack, MVC-like structure)</li>
                <li>Use case analysis for all user roles (Admin, User, Guest)</li>
                <li>Gap analysis of existing vs. required features</li>
              </ul>
              <p class="text-light small"><strong>Presentation Responsibilities:</strong></p>
              <ul class="text-warning small">
                <li><strong>Present:</strong> System Architecture & Requirements</li>
                <li><strong>Explain:</strong> Database schema (ERD), system components, directory structure</li>
                <li><strong>Demo:</strong> Requirements traceability matrix, use case diagrams</li>
                <li><strong>Highlight:</strong> Key problems solved (double booking, lost payments, communication lag)</li>
                <li><strong>Cover:</strong> Project goals, scope, constraints, and success metrics</li>
              </ul>
            </div>
          </div>

          <!-- Quality Control -->
          <div class="col-md-12">
            <div class="card p-4">
              <h6 class="text-gold mb-3">
                <i class="bi bi-shield-fill-check"></i> Quality Control (QC)
              </h6>
              <p class="text-light small"><strong>Primary Contributions:</strong></p>
              <ul class="text-light small">
                <li>Created comprehensive test plans and test cases</li>
                <li>Performed manual and automated testing (unit, integration, system, acceptance)</li>
                <li>Bug tracking and issue reporting (Jira/GitHub Issues)</li>
                <li>Validated all edge cases and error handling scenarios</li>
                <li>Security testing (CSRF, SQL injection, XSS attempts)</li>
                <li>Performance testing and load testing</li>
                <li>User acceptance testing (UAT) coordination</li>
                <li>Regression testing after bug fixes</li>
              </ul>
              <p class="text-light small"><strong>Presentation Responsibilities:</strong></p>
              <ul class="text-warning small">
                <li><strong>Present:</strong> Testing Strategy & Quality Assurance</li>
                <li><strong>Explain:</strong> Test coverage (authentication, booking, payment, refund flows)</li>
                <li><strong>Demo:</strong> Live testing scenarios (e.g., wrong OTP 5 times → account lock, archived account recovery)</li>
                <li><strong>Highlight:</strong> Bug reports, defect density, test case pass rates</li>
                <li><strong>Cover:</strong> Security validation (rate limiting, CSRF protection, email enumeration prevention)</li>
                <li><strong>Metrics:</strong> Test coverage percentage, critical bugs found & fixed, system stability</li>
              </ul>
            </div>
          </div>
        </div>

        <!-- Presentation Structure Recommendation -->
        <div class="card p-4 bg-dark border-gold">
          <h5 class="text-gold mb-3">
            <i class="bi bi-presentation"></i> Recommended Presentation Flow
          </h5>
          <div class="table-responsive">
            <table class="table table-dark table-hover border-secondary">
              <thead>
                <tr>
                  <th class="text-gold">Order</th>
                  <th class="text-gold">Presenter</th>
                  <th class="text-gold">Section</th>
                  <th class="text-gold">Duration</th>
                  <th class="text-gold">Key Points</th>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td>1</td>
                  <td>System Analyst</td>
                  <td>Introduction & Context</td>
                  <td>5 min</td>
                  <td>Problem statement, project goals, system architecture overview</td>
                </tr>
                <tr>
                  <td>2</td>
                  <td>UI/UX Designer</td>
                  <td>Design Showcase</td>
                  <td>5 min</td>
                  <td>UI/UX decisions, design system, user journey, responsive design</td>
                </tr>
                <tr>
                  <td>3</td>
                  <td>Full Stack Developer</td>
                  <td>Authentication System Deep Dive</td>
                  <td>10 min</td>
                  <td>Registration/Login/Forgot Password flows, security measures, live demo</td>
                </tr>
                <tr>
                  <td>4</td>
                  <td>Business Process Manager</td>
                  <td>Business Workflows</td>
                  <td>5 min</td>
                  <td>Booking process, refund automation, payment flow, process optimization</td>
                </tr>
                <tr>
                  <td>5</td>
                  <td>System Analyst</td>
                  <td>Database & API Architecture</td>
                  <td>5 min</td>
                  <td>ERD, table relationships, API endpoints, data flow</td>
                </tr>
                <tr>
                  <td>6</td>
                  <td>Quality Control</td>
                  <td>Testing & Quality Assurance</td>
                  <td>7 min</td>
                  <td>Test strategy, edge case validation, security testing, demo of error handling</td>
                </tr>
                <tr>
                  <td>7</td>
                  <td>Full Stack Developer</td>
                  <td>Live System Demo</td>
                  <td>8 min</td>
                  <td>End-to-end user journey (register → verify → login → book → pay)</td>
                </tr>
                <tr>
                  <td>8</td>
                  <td>All Team Members</td>
                  <td>Q&A</td>
                  <td>5 min</td>
                  <td>Panel answers questions from audience</td>
                </tr>
              </tbody>
            </table>
          </div>
        </div>
      </section>
    </main>

    
     

    <script src="../bootstrap-5.3.8-dist/js/bootstrap.bundle.min.js"></script>
    <script type="module">
      import mermaid from "https://cdn.jsdelivr.net/npm/mermaid@10/dist/mermaid.esm.min.mjs";
      mermaid.initialize({ startOnLoad: true, theme: "dark" });
    </script>
    <script>
      // SPA-like Navigation Logic
      document.addEventListener("DOMContentLoaded", () => {
        const links = document.querySelectorAll(".nav-link");
        const sections = document.querySelectorAll("main > section");

        function showSection(targetId) {
          // Hide all sections
          sections.forEach((section) => {
            section.style.display = "none";
          });

          // Show target section
          const targetSection = document.querySelector(targetId);
          if (targetSection) {
            targetSection.style.display = "block";
            window.scrollTo(0, 0);
          }
        }

        // Initial Load
        const hash = window.location.hash || "#overview";
        showSection(hash);

        // Set active link
        links.forEach((l) => {
          if (l.getAttribute("href") === hash) l.classList.add("active");
          else l.classList.remove("active");
        });

        // Click Handler
        links.forEach((link) => {
          link.addEventListener("click", function (e) {
            e.preventDefault();
            const targetId = this.getAttribute("href");

            // Update UI
            showSection(targetId);

            // Update Active State
            links.forEach((l) => l.classList.remove("active"));
            this.classList.add("active");

            // Update URL without scroll
            history.pushState(null, null, targetId);
          });
        });
      });
    </script>
  </body>
</html>
